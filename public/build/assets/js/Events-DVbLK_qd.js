import{O as W,b as n,d as i,e as t,i as m,j as z,f as B,v as D,A as w,t as d,F as h,k as x,n as q,m as N,q as M,g as I,h as Y,r as k,c as R,o as Z,B as J,w as K,N as $}from"./vue-vendor-wiowK_YT.js";import{u as ee}from"./events-BiwlR7Rs.js";import{E as te}from"./EventCard-ufma8XCH.js";import{_ as oe}from"./account-CYVf-4X6.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-xH9DYcoO.js";const re={name:"Events",components:{EventCard:te,ExclamationTriangleIcon:W},setup(){const C=$(),o=J(),L=ee(),r=k([]),E=k(!0),u=k("all"),p=k([]),c=k(""),S=s=>{try{const a=s.event_date||s.date;return a?new Date(a)<new Date:!1}catch{return!1}},e=R(()=>{let s=r.value;if(u.value!=="all"&&(s=s.filter(a=>(a.category?.id||a.category_id)===parseInt(u.value))),c.value&&c.value.trim()){const a=c.value.toLowerCase().trim();s=s.filter(l=>{const f=l.title?.toLowerCase().includes(a),_=l.description?.toLowerCase().includes(a),v=l.venue_name?.toLowerCase().includes(a)||l.venue?.name?.toLowerCase().includes(a)||typeof l.venue=="string"&&l.venue?.toLowerCase().includes(a),y=l.organizer?.name?.toLowerCase().includes(a)||typeof l.organizer=="string"&&l.organizer?.toLowerCase().includes(a),g=l.category?.name?.toLowerCase().includes(a)||l.category_name?.toLowerCase().includes(a);return f||_||v||y||g})}return s.filter(a=>!S(a))}),b=R(()=>{let s=r.value;if(u.value!=="all"&&(s=s.filter(a=>(a.category?.id||a.category_id)===parseInt(u.value))),c.value&&c.value.trim()){const a=c.value.toLowerCase().trim();s=s.filter(l=>{const f=l.title?.toLowerCase().includes(a),_=l.description?.toLowerCase().includes(a),v=l.venue_name?.toLowerCase().includes(a)||l.venue?.name?.toLowerCase().includes(a)||typeof l.venue=="string"&&l.venue?.toLowerCase().includes(a),y=l.organizer?.name?.toLowerCase().includes(a)||typeof l.organizer=="string"&&l.organizer?.toLowerCase().includes(a),g=l.category?.name?.toLowerCase().includes(a)||l.category_name?.toLowerCase().includes(a);return f||_||v||y||g})}return s.filter(a=>S(a))}),T=async()=>{try{E.value=!0;const s=await L.fetchEvents();r.value=s.events||[]}catch(s){console.error("Erreur lors du chargement des événements:",s),r.value=[]}finally{E.value=!1}},j=async()=>{try{const s=await fetch("/api/client/categories",{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();a.success&&a.categories&&(p.value=[{id:"all",name:"Tous"},...a.categories.map(l=>({id:l.id,name:l.name,slug:l.slug}))])}catch(s){console.error("Erreur lors du chargement des catégories:",s),p.value=[{id:"all",name:"Tous"},{id:1,name:"Musique"},{id:2,name:"Culture"},{id:3,name:"Gastronomie"},{id:4,name:"Sport"},{id:5,name:"Business"}]}},F=s=>{if(!s)return"--";try{let a;if(s.includes("T")||s.includes("Z"))a=new Date(s);else if(s.includes("/")){const g=s.split(" "),[O,H,G]=g[0].split("/"),U=g[1]||"00:00:00";a=new Date(`${G}-${H.padStart(2,"0")}-${O.padStart(2,"0")}T${U}`)}else s.includes("-")?a=new Date(s.replace(" ","T")):a=new Date(s);if(isNaN(a.getTime()))return"--";const l=a.getDate().toString().padStart(2,"0"),f=(a.getMonth()+1).toString().padStart(2,"0"),_=a.getFullYear(),v=a.getHours().toString().padStart(2,"0"),y=a.getMinutes().toString().padStart(2,"0");return`${l}/${f}/${_} ${v}:${y}`}catch{return"--"}},V=s=>!s||s===0?"Gratuit":new Intl.NumberFormat("fr-FR").format(s),A=s=>{C.push(`/events/${s.slug}`)},P=s=>{u.value=s.toString()},Q=()=>{c.value&&c.value.trim()&&C.push({path:"/events",query:{search:c.value.trim()}})},X=()=>{c.value="",C.push({path:"/events"})};return Z(()=>{o.query.search&&(c.value=o.query.search),o.query.category&&(u.value=o.query.category.toString()),T(),j()}),K(()=>o.query,s=>{s.category?u.value=s.category.toString():u.value="all",s.search?c.value=s.search:!s.search&&c.value&&(c.value="")}),{events:r,loading:E,selectedCategory:u,categories:p,searchQuery:c,filteredEvents:e,pastEvents:b,formatEventDate:F,formatPrice:V,goToEvent:A,filterByCategory:P,performSearch:Q,clearSearch:X,loadEvents:T,loadCategories:j,eventsStore:L}}},se={class:"events-page min-h-screen bg-gray-50 font-primea"},ae={class:"hidden md:block"},ie={class:"container mx-auto px-4 py-12"},le={class:"max-w-2xl mx-auto mb-12"},ne={key:0,class:"mt-4 text-center"},de={class:"text-gray-600"},ce={class:"font-bold text-primea-blue"},me={class:"mb-12"},ue={class:"flex flex-wrap justify-center gap-4"},pe=["onClick"],ge={key:0,class:"mb-16"},he={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8"},xe={key:1,class:"mb-16"},be={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 opacity-75"},fe={key:2,class:"text-center py-20"},_e={class:"bg-white rounded-primea-xl shadow-primea-lg p-12"},ve={class:"mb-6"},ye={key:0},we={class:"text-gray-600 mb-6"},ke={key:1},Ce={class:"md:hidden"},Ee={class:"max-w-md mx-auto px-4 py-8"},Se={class:"mb-6"},Le={key:0,class:"mt-3 text-center"},Me={class:"text-gray-800 text-sm"},Te={class:"font-bold text-primea-blue"},je={class:"mb-6"},ze={class:"flex flex-wrap gap-2"},Be=["onClick"],De={key:0,class:"mb-8"},qe={class:"space-y-4"},Ne=["onClick"],Ie={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},Re=["src","alt"],Fe={class:"absolute inset-0 p-4 text-white"},Ve={class:"flex justify-between items-start mb-4"},Ae={class:"text-xs"},Pe={class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold uppercase"},Qe={class:"font-bold"},Xe={class:"text-right text-xs"},Oe={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},He={key:0,class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},Ge={class:"absolute bottom-4 left-4 right-4"},Ue={class:"flex justify-between items-end"},We={class:"text-xs"},Ye={class:"flex space-x-2 mb-2"},Ze={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},Je={key:1,class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},Ke={class:"text-xs text-gray-200"},$e={class:"text-right"},et={class:"text-xs font-bold text-primea-yellow"},tt={key:1,class:"mb-8"},ot={class:"space-y-4 opacity-75"},rt=["onClick"],st={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},at=["src","alt"],it={class:"absolute inset-0 p-4 text-white"},lt={class:"flex justify-between items-start mb-4"},nt={class:"text-xs"},dt={class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold uppercase"},ct={class:"font-bold"},mt={class:"text-right text-xs"},ut={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},pt={key:0,class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},gt={class:"absolute bottom-4 left-4 right-4"},ht={class:"flex justify-between items-end"},xt={class:"text-xs"},bt={class:"flex space-x-2 mb-2"},ft={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},_t={key:1,class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},vt={class:"text-xs text-gray-200"},yt={class:"text-right"},wt={class:"text-xs font-bold text-primea-yellow"},kt={key:2,class:"text-center py-12"},Ct={key:0,class:"text-red-400 mb-4"},Et={class:"text-sm"},St={key:1,class:"text-white/80 mb-4"};function Lt(C,o,L,r,E,u){const p=M("EventCard"),c=M("ExclamationTriangleIcon"),S=M("router-link");return i(),n("div",se,[t("div",ae,[t("div",ie,[t("div",le,[t("form",{onSubmit:o[1]||(o[1]=z((...e)=>r.performSearch&&r.performSearch(...e),["prevent"])),class:"relative"},[B(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>r.searchQuery=e),placeholder:"Rechercher un événement par titre, lieu, organisateur...",class:"w-full px-6 py-4 rounded-primea-lg text-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow shadow-primea border-2 border-transparent focus:border-primea-yellow transition-all"},null,512),[[D,r.searchQuery]]),o[8]||(o[8]=t("button",{type:"submit",class:"absolute right-3 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-3 rounded-primea hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),r.searchQuery&&r.searchQuery.trim()?(i(),n("div",ne,[t("p",de,[o[9]||(o[9]=w(" Résultats pour: ",-1)),t("span",ce,'"'+d(r.searchQuery)+'"',1),t("button",{onClick:o[2]||(o[2]=(...e)=>r.clearSearch&&r.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ Effacer ")])])):m("",!0)]),t("div",me,[o[10]||(o[10]=t("h2",{class:"text-2xl font-bold text-primea-blue text-center mb-8"}," Filtrer par catégorie ",-1)),t("div",ue,[(i(!0),n(h,null,x(r.categories,e=>(i(),n("button",{key:e.id,onClick:b=>r.filterByCategory(e.id),class:q(["px-10 py-4 rounded-primea-lg text-lg font-bold transition-all duration-200 transform hover:scale-105 shadow-primea border-2",r.selectedCategory===e.id?"bg-primea-blue text-white border-primea-blue shadow-primea-lg scale-105":"bg-white text-primea-blue border-primea-blue hover:bg-primea-blue hover:text-white"])},d(e.name),11,pe))),128))])]),r.filteredEvents.length>0?(i(),n("div",ge,[o[11]||(o[11]=t("h2",{class:"text-2xl font-bold text-primea-blue mb-8"},"Événements à venir",-1)),t("div",he,[(i(!0),n(h,null,x(r.filteredEvents,e=>(i(),N(p,{key:e.id,event:e,class:"transform hover:scale-105 transition-all duration-300"},null,8,["event"]))),128))])])):m("",!0),r.pastEvents.length>0?(i(),n("div",xe,[o[12]||(o[12]=t("h2",{class:"text-2xl font-bold text-gray-600 mb-8 flex items-center gap-2"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),w(" Événements passés ")],-1)),t("div",be,[(i(!0),n(h,null,x(r.pastEvents,e=>(i(),N(p,{key:e.id,event:e,class:"transform hover:scale-105 transition-all duration-300 grayscale hover:grayscale-0"},null,8,["event"]))),128))])])):m("",!0),r.filteredEvents.length===0&&!r.loading?(i(),n("div",fe,[t("div",_e,[t("div",ve,[I(c,{class:"w-16 h-16 text-primea-blue/40 mx-auto"})]),r.eventsStore.error?(i(),n("div",ye,[o[13]||(o[13]=t("p",{class:"text-red-600 mb-4 text-xl font-semibold"},"⚠️ Erreur de connexion",-1)),t("p",we,d(r.eventsStore.error),1),t("button",{onClick:o[3]||(o[3]=(...e)=>r.loadEvents&&r.loadEvents(...e)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea"}," Réessayer ")])):(i(),n("div",ke,[o[14]||(o[14]=t("p",{class:"text-primea-blue mb-6 text-xl font-semibold"},"Aucun événement trouvé pour cette catégorie.",-1)),t("button",{onClick:o[4]||(o[4]=e=>r.filterByCategory("all")),class:"bg-primea-yellow text-primea-blue px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"}," Voir tous les événements ")]))])])):m("",!0)])]),t("div",Ce,[t("div",Ee,[t("div",Se,[t("form",{onSubmit:o[6]||(o[6]=z((...e)=>r.performSearch&&r.performSearch(...e),["prevent"])),class:"relative"},[B(t("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=e=>r.searchQuery=e),placeholder:"Rechercher un événement...",class:"w-full px-4 py-3 rounded-primea-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow"},null,512),[[D,r.searchQuery]]),o[15]||(o[15]=t("button",{type:"submit",class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-2 rounded-primea"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),r.searchQuery&&r.searchQuery.trim()?(i(),n("div",Le,[t("p",Me,[o[16]||(o[16]=w(" Résultats pour: ",-1)),t("span",Te,'"'+d(r.searchQuery)+'"',1),t("button",{onClick:o[7]||(o[7]=(...e)=>r.clearSearch&&r.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ ")])])):m("",!0)]),t("div",je,[o[17]||(o[17]=t("h3",{class:"text-gray-800 text-sm font-bold mb-3"},"Catégories",-1)),t("div",ze,[(i(!0),n(h,null,x(r.categories,e=>(i(),n("button",{key:e.id,onClick:b=>r.filterByCategory(e.id),class:q(["px-4 py-2 rounded-primea text-sm font-bold transition-all duration-200",r.selectedCategory===e.id?"bg-primea-yellow text-primea-blue":"bg-white text-primea-blue border-2 border-primea-blue hover:bg-primea-yellow hover:text-primea-blue"])},d(e.name),11,Be))),128))])]),r.filteredEvents.length>0?(i(),n("div",De,[o[20]||(o[20]=t("h3",{class:"text-gray-800 text-lg font-bold mb-4"},"Événements à venir",-1)),t("div",qe,[(i(!0),n(h,null,x(r.filteredEvents,e=>(i(),n("div",{key:e.id,onClick:b=>r.goToEvent(e),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105"},[t("div",Ie,[e.image||e.image_url||e.image_file?(i(),n("img",{key:0,src:e.image_url||e.image||e.image_file,alt:e.title,class:"w-full h-full object-cover"},null,8,Re)):m("",!0),o[19]||(o[19]=t("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),t("div",Fe,[t("div",Ve,[t("div",Ae,[t("div",Pe,d(e.category?.name||e.category_name||"ÉVÉNEMENT"),1),t("div",Qe,d(e.title),1)]),t("div",Xe,[t("div",Oe,d(r.formatEventDate(e.event_date||e.date)),1),e.min_age?(i(),n("div",He,d(e.min_age)+"+",1)):m("",!0)])]),t("div",Ge,[t("div",Ue,[t("div",We,[t("div",Ye,[e.min_price&&e.min_price>0?(i(),n("div",Ze,d(r.formatPrice(e.min_price))+" XAF ",1)):m("",!0),e.max_price&&e.max_price>0&&e.max_price!==e.min_price?(i(),n("div",Je,d(r.formatPrice(e.max_price))+" XAF ",1)):m("",!0)]),t("div",Ke,d(e.venue?.name||e.venue_name||"Lieu à confirmer"),1)]),t("div",$e,[o[18]||(o[18]=t("div",{class:"text-xs text-gray-200"},"Organisé par",-1)),t("div",et,d(e.organizer?.name||"Organisateur"),1)])])])])])],8,Ne))),128))])])):m("",!0),r.pastEvents.length>0?(i(),n("div",tt,[o[23]||(o[23]=t("h3",{class:"text-gray-600 text-lg font-bold mb-4 flex items-center gap-2"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),w(" Événements passés ")],-1)),t("div",ot,[(i(!0),n(h,null,x(r.pastEvents,e=>(i(),n("div",{key:e.id,onClick:b=>r.goToEvent(e),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105 grayscale hover:grayscale-0"},[t("div",st,[e.image||e.image_url||e.image_file?(i(),n("img",{key:0,src:e.image_url||e.image||e.image_file,alt:e.title,class:"w-full h-full object-cover"},null,8,at)):m("",!0),o[22]||(o[22]=t("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),t("div",it,[t("div",lt,[t("div",nt,[t("div",dt,d(e.category?.name||e.category_name||"ÉVÉNEMENT"),1),t("div",ct,d(e.title),1)]),t("div",mt,[t("div",ut,d(r.formatEventDate(e.event_date||e.date)),1),e.min_age?(i(),n("div",pt,d(e.min_age)+"+",1)):m("",!0)])]),t("div",gt,[t("div",ht,[t("div",xt,[t("div",bt,[e.min_price&&e.min_price>0?(i(),n("div",ft,d(r.formatPrice(e.min_price))+" XAF ",1)):m("",!0),e.max_price&&e.max_price>0&&e.max_price!==e.min_price?(i(),n("div",_t,d(r.formatPrice(e.max_price))+" XAF ",1)):m("",!0)]),t("div",vt,d(e.venue?.name||e.venue_name||"Lieu à confirmer"),1)]),t("div",yt,[o[21]||(o[21]=t("div",{class:"text-xs text-gray-200"},"Organisé par",-1)),t("div",wt,d(e.organizer?.name||"Organisateur"),1)])])])])])],8,rt))),128))])])):m("",!0),r.filteredEvents.length===0&&!r.loading?(i(),n("div",kt,[r.eventsStore.error?(i(),n("div",Ct,[o[24]||(o[24]=t("div",{class:"text-lg font-semibold mb-2"},"⚠️ Erreur de connexion",-1)),t("div",Et,d(r.eventsStore.error),1)])):(i(),n("div",St,"Aucun événement disponible pour le moment.")),I(S,{to:"/",class:"text-primea-yellow hover:text-white font-medium"},{default:Y(()=>[...o[25]||(o[25]=[w(" ← Retourner à l'accueil ",-1)])]),_:1})])):m("",!0)])])])}const qt=oe(re,[["render",Lt],["__scopeId","data-v-3bda12ce"]]);export{qt as default};
