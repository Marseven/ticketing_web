import{d as x,g as n,o as d,h as e,n as c,l as h,t as b,A as v,j as y,a as E,U as f,F as R,b as k,e as N,B as S,N as z}from"./vue-vendor-DkyC1Igy.js";import{_ as w,t as I}from"./account-BPl4L88c.js";import"./pinia-vendor-T35r7xXn.js";import"./vendor-BvANJOFB.js";const D={name:"TicketComponent",props:{ticket:{type:Object,required:!0},size:{type:String,default:"large",validator:i=>["small","large"].includes(i)}},setup(i){const t=x(()=>i.ticket?.event?.date?new Date(i.ticket.event.date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).toUpperCase():"DIMANCHE 27 JUILLET 2025"),s=x(()=>i.ticket?.event?.date?new Date(i.ticket.event.date).getDate():"27"),a=x(()=>i.ticket?.event?.date?new Date(i.ticket.event.date).toLocaleDateString("fr-FR",{month:"long"}).toUpperCase():"JUILLET"),m=x(()=>i.ticket?.event?.time?`DÈS ${i.ticket.event.time}`:"DÈS 13H");return{formatEventDate:t,eventDay:s,eventMonth:a,eventTime:m,formatPrice:r=>r?new Intl.NumberFormat("fr-FR").format(r):"10.000",generateQRCode:()=>{if(i.ticket?.qrCode)return i.ticket.qrCode;const r=i.ticket?.reference||"PRIMEA-TICKET";return`data:image/svg+xml;base64,${btoa(`
        <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <pattern id="qr" patternUnits="userSpaceOnUse" width="10" height="10">
              <rect width="5" height="5" fill="#000"/>
              <rect x="5" y="5" width="5" height="5" fill="#000"/>
            </pattern>
          </defs>
          <rect width="100" height="100" fill="url(#qr)"/>
          <text x="50" y="50" text-anchor="middle" fill="#333" font-size="8">${r.slice(-4)}</text>
        </svg>
      `)}`}}}},U={class:"relative"},B=["src","alt"],j={class:"flex justify-between items-start"},A={class:"flex-1"},M={class:"mb-4"},L={class:"mb-4 space-y-1"},P={class:"font-semibold text-gray-800"},q={class:"text-gray-600 text-sm"},F={class:"mb-4"},O={class:"font-semibold text-gray-800"},V={class:"mb-4"},Q={class:"mb-3"},H={class:"bg-white p-2 border-2 border-gray-300 rounded-primea"},K=["src"];function J(i,t,s,a,m,u){return d(),n("div",{class:c(["ticket-component bg-white rounded-primea-xl overflow-hidden font-primea",s.size==="small"?"max-w-sm":"max-w-2xl","shadow-primea-lg"])},[e("div",U,[e("div",{class:c(["relative overflow-hidden bg-primea-gradient",s.size==="small"?"h-40":"h-56"])},[s.ticket?.event?.image?(d(),n("img",{key:0,src:s.ticket.event.image,alt:s.ticket.event?.title,class:"w-full h-full object-cover"},null,8,B)):h("",!0),t[0]||(t[0]=e("div",{class:"absolute inset-0 bg-black/30"},null,-1))],2)]),e("div",{class:c(["p-4 bg-gray-50 border-t-4 border-dashed border-gray-300",s.size==="small"?"text-sm":"text-base"])},[e("div",j,[e("div",A,[e("div",M,[e("h3",{class:c(["font-bold text-primea-blue mb-2",s.size==="small"?"text-lg":"text-3xl"])},b(s.ticket?.event?.title||"L'OISEAU RARE"),3)]),e("div",L,[e("div",P,b(a.formatEventDate),1),e("div",q,"À "+b(s.ticket?.event?.venue_name?.toUpperCase()||"ENTRE NOUS BAR"),1)]),e("div",F,[t[1]||(t[1]=e("span",{class:"text-sm text-gray-600"},"Catégorie : ",-1)),e("span",O,b(s.ticket?.ticketType||"standard"),1)]),e("div",V,[e("div",{class:c(["font-bold text-primea-blue",s.size==="small"?"text-lg":"text-2xl"])},b(a.formatPrice(s.ticket?.price))+" XAF ",3)]),t[2]||(t[2]=e("div",{class:"text-xs text-red-600 leading-tight mb-4"},[e("strong",null,"*ATTENTION:*"),e("br"),v(" CE TICKET EST STRICTEMENT PERSONNEL ET À USAGE"),e("br"),v(" UNIQUE. IL NE PEUT ÊTRE NI VENDU NI DONNÉ À AUTRUI"),e("br"),v(" SOUS PEINE D'ÊTRE REFUSÉ À L'ENTRÉE. ")],-1)),t[3]||(t[3]=e("div",{class:"flex justify-start"},[e("img",{src:"/images/logo.png",alt:"Primea",class:"h-6"})],-1))]),e("div",{class:c(["ml-4 text-center",s.size==="small"?"w-20":"w-32"])},[e("div",Q,[e("div",{class:c(["font-bold text-primea-blue",s.size==="small"?"text-sm":"text-lg"])},b(s.ticket?.reference||"0001"),3)]),e("div",H,[e("img",{src:s.ticket?.qrCode||a.generateQRCode(),alt:"QR Code",class:c(["object-contain mx-auto",s.size==="small"?"w-16 h-16":"w-24 h-24"])},null,10,K)]),t[4]||(t[4]=e("p",{class:"text-xs text-gray-500 mt-2 leading-tight"},[v(" Ce QR Code est unique"),e("br"),v(" et ne peut être scanné"),e("br"),v(" qu'une seule fois ")],-1))],2)])],2)],2)}const G=w(D,[["render",J],["__scopeId","data-v-90a5349e"]]),X={name:"TicketDownload",components:{TicketComponent:G},setup(){const i=S(),t=z(),s=k(null),a=k(!0),m=k(""),u=async()=>{try{a.value=!0,m.value="";const l=i.params.id,p=await I.getTicket(l);if(p.data?.ticket){const o=p.data.ticket,_=o.event.image_url||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800";s.value={id:o.id,reference:o.code,event:{id:o.event.id,title:o.event.title,date:o.schedule?.starts_at?new Date(o.schedule.starts_at.split("/").reverse().join("-")).toISOString():"2025-07-27T20:00:00",venue_name:o.event.venue_name||"Entre Nous Bar",image:_,time:o.schedule?.door_time?new Date(o.schedule.door_time.split("/").reverse().join("-")).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"13H"},ticketType:o.ticket_type?.name||"Standard",price:o.ticket_type?.price||1e4,qrCode:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(o.code)}`,status:o.status,buyer_name:o.buyer?.name,buyer_email:o.buyer?.email,issued_at:o.issued_at,used_at:o.used_at}}}catch(l){console.error("Erreur lors du chargement du ticket:",l),m.value=l.response?.data?.message||"Erreur lors du chargement du ticket",s.value={id:i.params.id,reference:"TKT-2024-ABC123",event:{title:"L'OISEAU RARE",date:"2025-07-27T20:00:00",venue_name:"Entre Nous Bar",image:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800",time:"13H"},ticketType:"Standard",price:1e4,status:"issued"}}finally{a.value=!1}},g=x(()=>s.value?.event?.date?new Date(s.value.event.date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).toUpperCase():"DIMANCHE 27 JUILLET 2025"),r=l=>l?new Intl.NumberFormat("fr-FR").format(l):"10.000",T=async()=>{try{const l=i.params.id;window.open(`/api/v1/tickets/${l}/pdf`,"_blank")}catch(l){console.error("Erreur lors du téléchargement:",l),alert("Erreur lors du téléchargement du ticket")}},C=()=>{t.back()};return N(()=>{u()}),{ticket:s,loading:a,error:m,formatEventDate:g,formatPrice:r,downloadTicket:T,goBack:C,loadTicket:u}}},W={class:"ticket-download-page font-primea min-h-screen"},Y={class:"hidden md:block bg-gray-50 min-h-screen"},Z={class:"container mx-auto px-4 py-12"},$={class:"max-w-6xl mx-auto"},ee={key:0,class:"text-center py-12"},te={key:1,class:"bg-red-50 border border-red-200 rounded-primea-xl p-6 text-center"},ae={class:"text-red-600 mb-4"},se={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},re={class:"lg:col-span-2 flex justify-center"},ie={class:"lg:col-span-1 space-y-6"},oe={class:"bg-white rounded-primea-xl shadow-primea p-6"},le={class:"space-y-3"},ne={class:"md:hidden bg-gray-100 min-h-screen py-8 px-4"},de={class:"max-w-md mx-auto"},ce={key:0,class:"text-center py-12"},be={key:1,class:"bg-red-50 border border-red-200 rounded-primea-xl p-6 text-center"},me={class:"text-red-600 mb-4"},ve={class:"flex items-center justify-between mb-8"},ue={class:"mb-6"},ge={class:"mb-8"};function xe(i,t,s,a,m,u){const g=E("TicketComponent");return d(),n("div",W,[e("div",Y,[e("div",Z,[e("div",$,[t[12]||(t[12]=e("div",{class:"text-center mb-12"},[e("img",{src:"/images/logo.png",alt:"Primea",class:"h-16 mx-auto mb-6"}),e("h1",{class:"text-4xl font-bold text-primea-blue mb-4"},"Votre ticket électronique"),e("p",{class:"text-lg text-gray-600"},"Téléchargez ou capturez votre ticket pour l'événement")],-1)),a.loading?(d(),n("div",ee,[...t[6]||(t[6]=[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primea-blue"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement du ticket...",-1)])])):a.error?(d(),n("div",te,[t[7]||(t[7]=e("div",{class:"flex items-center justify-center mb-4"},[e("svg",{class:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t[8]||(t[8]=e("h3",{class:"text-lg font-semibold text-red-800 mb-2"},"Ticket introuvable",-1)),e("p",ae,b(a.error),1),e("button",{onClick:t[0]||(t[0]=(...r)=>a.loadTicket&&a.loadTicket(...r)),class:"bg-primea-blue text-white px-6 py-2 rounded-primea-lg hover:bg-primea-yellow hover:text-primea-blue transition-colors"}," Réessayer ")])):a.ticket?(d(),n("div",se,[e("div",re,[y(g,{ticket:a.ticket,size:"large"},null,8,["ticket"])]),e("div",ie,[t[11]||(t[11]=f('<div class="bg-white rounded-primea-xl shadow-primea p-6" data-v-3bebb7c5><h3 class="text-xl font-bold text-primea-blue mb-4" data-v-3bebb7c5>Comment utiliser votre ticket</h3><div class="space-y-4 text-gray-600" data-v-3bebb7c5><div class="flex items-start gap-3" data-v-3bebb7c5><div class="rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mt-0.5 flex-shrink-0" style="background-color:#272d63;color:white;" data-v-3bebb7c5>1</div><div data-v-3bebb7c5><p class="font-semibold text-gray-800" data-v-3bebb7c5>Téléchargez votre ticket</p><p class="text-sm" data-v-3bebb7c5>Cliquez sur le bouton de téléchargement pour sauvegarder votre ticket en PDF</p></div></div><div class="flex items-start gap-3" data-v-3bebb7c5><div class="rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mt-0.5 flex-shrink-0" style="background-color:#272d63;color:white;" data-v-3bebb7c5>2</div><div data-v-3bebb7c5><p class="font-semibold text-gray-800" data-v-3bebb7c5>Présentez le QR code</p><p class="text-sm" data-v-3bebb7c5>À l&#39;entrée, montrez le QR code pour validation</p></div></div><div class="flex items-start gap-3" data-v-3bebb7c5><div class="rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold mt-0.5 flex-shrink-0" style="background-color:#fab511;color:#272d63;" data-v-3bebb7c5>!</div><div data-v-3bebb7c5><p class="font-semibold text-red-600" data-v-3bebb7c5>Important</p><p class="text-sm" data-v-3bebb7c5>Ce ticket est personnel et à usage unique. Il ne peut être ni vendu ni donné</p></div></div></div></div>',1)),e("div",oe,[t[10]||(t[10]=e("h3",{class:"text-xl font-bold text-primea-blue mb-4"},"Actions",-1)),e("div",le,[e("button",{onClick:t[1]||(t[1]=(...r)=>a.downloadTicket&&a.downloadTicket(...r)),class:"w-full py-3 px-6 rounded-primea-lg font-semibold transition-all duration-200 shadow-primea flex items-center justify-center gap-2",style:{"background-color":"#fab511",color:"#272d63"}},[...t[9]||(t[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" Télécharger le ticket PDF ",-1)])]),e("button",{onClick:t[2]||(t[2]=(...r)=>a.goBack&&a.goBack(...r)),class:"w-full border-2 border-primea-blue text-primea-blue py-3 px-6 rounded-primea-lg font-semibold hover:bg-primea-blue hover:text-white transition-all duration-200"}," Retour aux événements ")])])])])):h("",!0)])])]),e("div",ne,[e("div",de,[a.loading?(d(),n("div",ce,[...t[13]||(t[13]=[e("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primea-blue"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement du ticket...",-1)])])):a.error?(d(),n("div",be,[t[14]||(t[14]=e("div",{class:"flex items-center justify-center mb-4"},[e("svg",{class:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t[15]||(t[15]=e("h3",{class:"text-lg font-semibold text-red-800 mb-2"},"Ticket introuvable",-1)),e("p",me,b(a.error),1),e("button",{onClick:t[3]||(t[3]=(...r)=>a.loadTicket&&a.loadTicket(...r)),class:"bg-primea-blue text-white px-6 py-2 rounded-primea-lg hover:bg-primea-yellow hover:text-primea-blue transition-colors"}," Réessayer ")])):a.ticket?(d(),n(R,{key:2},[e("div",ve,[e("button",{onClick:t[4]||(t[4]=(...r)=>a.goBack&&a.goBack(...r)),class:"text-gray-600 hover:text-gray-800"},[...t[16]||(t[16]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t[17]||(t[17]=f('<div class="text-center" data-v-3bebb7c5><img src="/images/logo.png" alt="Primea" class="h-8 mx-auto mb-2" data-v-3bebb7c5><div class="text-center" data-v-3bebb7c5><div class="text-lg font-bold text-primea-blue" data-v-3bebb7c5>La Billetterie</div><div class="text-xs text-gray-500" data-v-3bebb7c5>Simple, Rapide et Sécurisée</div></div></div><button class="text-gray-600" data-v-3bebb7c5><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-3bebb7c5><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" data-v-3bebb7c5></path></svg></button>',2))]),t[18]||(t[18]=f('<div class="text-center mb-8" data-v-3bebb7c5><h1 class="text-lg font-medium text-gray-700 mb-2" data-v-3bebb7c5> Téléchargez ou capturez l&#39;écran </h1><p class="text-gray-600" data-v-3bebb7c5> pour conserver votre ticket </p></div><div class="text-center mb-6" data-v-3bebb7c5><h2 class="text-lg font-bold text-primea-blue" data-v-3bebb7c5>VOTRE TICKET</h2></div>',2)),e("div",ue,[y(g,{ticket:a.ticket,size:"small"},null,8,["ticket"])]),e("div",ge,[e("button",{onClick:t[5]||(t[5]=(...r)=>a.downloadTicket&&a.downloadTicket(...r)),class:"w-full py-3 px-6 rounded-primea-lg font-semibold transition-colors duration-200",style:{"background-color":"#fab511",color:"#272d63"}}," Télécharger ")]),t[19]||(t[19]=f('<div class="bg-gray-200 rounded-primea-lg p-8 text-center mb-6" data-v-3bebb7c5><div class="text-xl text-gray-400 font-light mb-4" data-v-3bebb7c5>ESPACE PUB</div><a href="#" class="text-primea-blue text-sm hover:text-primea-yellow" data-v-3bebb7c5>En savoir plus...</a></div><div class="text-center" data-v-3bebb7c5><img src="/images/logo.png" alt="Primea" class="h-8 mx-auto mb-4" data-v-3bebb7c5><div class="flex justify-center space-x-4" data-v-3bebb7c5><a href="#" class="text-green-500 hover:text-green-600" data-v-3bebb7c5><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" data-v-3bebb7c5><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488" data-v-3bebb7c5></path></svg></a><a href="#" class="text-blue-600 hover:text-blue-700" data-v-3bebb7c5><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" data-v-3bebb7c5><path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" data-v-3bebb7c5></path></svg></a><a href="#" class="text-pink-500 hover:text-pink-600" data-v-3bebb7c5><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" data-v-3bebb7c5><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.347-.09.375-.293 1.199-.332 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.746-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001.012.001z" data-v-3bebb7c5></path></svg></a></div></div>',2))],64)):h("",!0)])])])}const ye=w(X,[["render",xe],["__scopeId","data-v-3bebb7c5"]]);export{ye as default};
