import{O as H,b as l,d as i,e as t,i as u,j as L,f as B,v as q,A as T,t as c,F as v,k as y,n as R,m as O,q as M,g as j,h as G,r as g,c as U,o as W,B as Y,w as Z,N as J}from"./vue-vendor-DL4qlPdi.js";import{u as K}from"./events-RwIa-wgR.js";import{E as $}from"./EventCard-DWtwEIc5.js";import{_ as ee}from"./account-D3HL21EZ.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-DSZd9EMP.js";const te={name:"Events",components:{EventCard:$,ExclamationTriangleIcon:H},setup(){const b=J(),r=Y(),_=K(),o=g([]),x=g(!0),m=g("all"),p=g([]),d=g(""),w=U(()=>{let s=o.value;if(m.value!=="all"&&(s=s.filter(a=>(a.category?.id||a.category_id)===parseInt(m.value))),d.value&&d.value.trim()){const a=d.value.toLowerCase().trim();s=s.filter(n=>{const k=n.title?.toLowerCase().includes(a),C=n.description?.toLowerCase().includes(a),E=n.venue_name?.toLowerCase().includes(a)||n.venue?.name?.toLowerCase().includes(a)||typeof n.venue=="string"&&n.venue?.toLowerCase().includes(a),S=n.organizer?.name?.toLowerCase().includes(a)||typeof n.organizer=="string"&&n.organizer?.toLowerCase().includes(a),f=n.category?.name?.toLowerCase().includes(a)||n.category_name?.toLowerCase().includes(a);return k||C||E||S||f})}return s}),e=async()=>{try{x.value=!0;const s=await _.fetchEvents();o.value=s.events||[]}catch(s){console.error("Erreur lors du chargement des événements:",s),o.value=[]}finally{x.value=!1}},h=async()=>{try{const s=await fetch("/api/client/categories",{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();a.success&&a.categories&&(p.value=[{id:"all",name:"Tous"},...a.categories.map(n=>({id:n.id,name:n.name,slug:n.slug}))])}catch(s){console.error("Erreur lors du chargement des catégories:",s),p.value=[{id:"all",name:"Tous"},{id:1,name:"Musique"},{id:2,name:"Culture"},{id:3,name:"Gastronomie"},{id:4,name:"Sport"},{id:5,name:"Business"}]}},N=s=>{if(!s)return"--";try{let a;if(s.includes("T")||s.includes("Z"))a=new Date(s);else if(s.includes("/")){const f=s.split(" "),[Q,A,P]=f[0].split("/"),X=f[1]||"00:00:00";a=new Date(`${P}-${A.padStart(2,"0")}-${Q.padStart(2,"0")}T${X}`)}else s.includes("-")?a=new Date(s.replace(" ","T")):a=new Date(s);if(isNaN(a.getTime()))return"--";const n=a.getDate().toString().padStart(2,"0"),k=(a.getMonth()+1).toString().padStart(2,"0"),C=a.getFullYear(),E=a.getHours().toString().padStart(2,"0"),S=a.getMinutes().toString().padStart(2,"0");return`${n}/${k}/${C} ${E}:${S}`}catch{return"--"}},D=s=>!s||s===0?"Gratuit":new Intl.NumberFormat("fr-FR").format(s),z=s=>{b.push(`/events/${s.slug}`)},F=s=>{m.value=s.toString()},I=()=>{d.value&&d.value.trim()&&b.push({path:"/events",query:{search:d.value.trim()}})},V=()=>{d.value="",b.push({path:"/events"})};return W(()=>{r.query.search&&(d.value=r.query.search),r.query.category&&(m.value=r.query.category.toString()),e(),h()}),Z(()=>r.query,s=>{s.category?m.value=s.category.toString():m.value="all",s.search?d.value=s.search:!s.search&&d.value&&(d.value="")}),{events:o,loading:x,selectedCategory:m,categories:p,searchQuery:d,filteredEvents:w,formatEventDate:N,formatPrice:D,goToEvent:z,filterByCategory:F,performSearch:I,clearSearch:V,loadEvents:e,loadCategories:h,eventsStore:_}}},re={class:"events-page min-h-screen bg-gray-50 font-primea"},oe={class:"hidden md:block"},se={class:"container mx-auto px-4 py-12"},ae={class:"max-w-2xl mx-auto mb-12"},ie={key:0,class:"mt-4 text-center"},le={class:"text-gray-600"},ne={class:"font-bold text-primea-blue"},de={class:"mb-12"},ce={class:"flex flex-wrap justify-center gap-4"},me=["onClick"],ue={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 mb-16"},pe={key:0,class:"text-center py-20"},he={class:"bg-white rounded-primea-xl shadow-primea-lg p-12"},ge={class:"mb-6"},be={key:0},xe={class:"text-gray-600 mb-6"},fe={key:1},ve={class:"md:hidden"},ye={class:"max-w-md mx-auto px-4 py-8"},_e={class:"mb-6"},we={key:0,class:"mt-3 text-center"},ke={class:"text-gray-800 text-sm"},Ce={class:"font-bold text-primea-blue"},Ee={class:"mb-6"},Se={class:"flex flex-wrap gap-2"},Te=["onClick"],Me={class:"space-y-4 mb-8"},Le=["onClick"],Be={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},qe=["src","alt"],Re={class:"absolute inset-0 p-4 text-white"},je={class:"flex justify-between items-start mb-4"},Ne={class:"text-xs"},De={class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold uppercase"},ze={class:"font-bold"},Fe={class:"text-right text-xs"},Ie={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},Ve={key:0,class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},Qe={class:"absolute bottom-4 left-4 right-4"},Ae={class:"flex justify-between items-end"},Pe={class:"text-xs"},Xe={class:"flex space-x-2 mb-2"},He={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},Oe={key:1,class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},Ge={class:"text-xs text-gray-200"},Ue={class:"text-right"},We={class:"text-xs font-bold text-primea-yellow"},Ye={key:0,class:"text-center py-12"},Ze={key:0,class:"text-red-400 mb-4"},Je={class:"text-sm"},Ke={key:1,class:"text-white/80 mb-4"};function $e(b,r,_,o,x,m){const p=M("EventCard"),d=M("ExclamationTriangleIcon"),w=M("router-link");return i(),l("div",re,[t("div",oe,[t("div",se,[t("div",ae,[t("form",{onSubmit:r[1]||(r[1]=L((...e)=>o.performSearch&&o.performSearch(...e),["prevent"])),class:"relative"},[B(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=e=>o.searchQuery=e),placeholder:"Rechercher un événement par titre, lieu, organisateur...",class:"w-full px-6 py-4 rounded-primea-lg text-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow shadow-primea border-2 border-transparent focus:border-primea-yellow transition-all"},null,512),[[q,o.searchQuery]]),r[8]||(r[8]=t("button",{type:"submit",class:"absolute right-3 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-3 rounded-primea hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),o.searchQuery&&o.searchQuery.trim()?(i(),l("div",ie,[t("p",le,[r[9]||(r[9]=T(" Résultats pour: ",-1)),t("span",ne,'"'+c(o.searchQuery)+'"',1),t("button",{onClick:r[2]||(r[2]=(...e)=>o.clearSearch&&o.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ Effacer ")])])):u("",!0)]),t("div",de,[r[10]||(r[10]=t("h2",{class:"text-2xl font-bold text-primea-blue text-center mb-8"}," Filtrer par catégorie ",-1)),t("div",ce,[(i(!0),l(v,null,y(o.categories,e=>(i(),l("button",{key:e.id,onClick:h=>o.filterByCategory(e.id),class:R(["px-10 py-4 rounded-primea-lg text-lg font-bold transition-all duration-200 transform hover:scale-105 shadow-primea border-2",o.selectedCategory===e.id?"bg-primea-blue text-white border-primea-blue shadow-primea-lg scale-105":"bg-white text-primea-blue border-primea-blue hover:bg-primea-blue hover:text-white"])},c(e.name),11,me))),128))])]),t("div",ue,[(i(!0),l(v,null,y(o.filteredEvents,e=>(i(),O(p,{key:e.id,event:e,class:"transform hover:scale-105 transition-all duration-300"},null,8,["event"]))),128))]),o.filteredEvents.length===0&&!o.loading?(i(),l("div",pe,[t("div",he,[t("div",ge,[j(d,{class:"w-16 h-16 text-primea-blue/40 mx-auto"})]),o.eventsStore.error?(i(),l("div",be,[r[11]||(r[11]=t("p",{class:"text-red-600 mb-4 text-xl font-semibold"},"⚠️ Erreur de connexion",-1)),t("p",xe,c(o.eventsStore.error),1),t("button",{onClick:r[3]||(r[3]=(...e)=>o.loadEvents&&o.loadEvents(...e)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea"}," Réessayer ")])):(i(),l("div",fe,[r[12]||(r[12]=t("p",{class:"text-primea-blue mb-6 text-xl font-semibold"},"Aucun événement trouvé pour cette catégorie.",-1)),t("button",{onClick:r[4]||(r[4]=e=>o.filterByCategory("all")),class:"bg-primea-yellow text-primea-blue px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"}," Voir tous les événements ")]))])])):u("",!0)])]),t("div",ve,[t("div",ye,[t("div",_e,[t("form",{onSubmit:r[6]||(r[6]=L((...e)=>o.performSearch&&o.performSearch(...e),["prevent"])),class:"relative"},[B(t("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=e=>o.searchQuery=e),placeholder:"Rechercher un événement...",class:"w-full px-4 py-3 rounded-primea-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow"},null,512),[[q,o.searchQuery]]),r[13]||(r[13]=t("button",{type:"submit",class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-2 rounded-primea"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),o.searchQuery&&o.searchQuery.trim()?(i(),l("div",we,[t("p",ke,[r[14]||(r[14]=T(" Résultats pour: ",-1)),t("span",Ce,'"'+c(o.searchQuery)+'"',1),t("button",{onClick:r[7]||(r[7]=(...e)=>o.clearSearch&&o.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ ")])])):u("",!0)]),t("div",Ee,[r[15]||(r[15]=t("h3",{class:"text-gray-800 text-sm font-bold mb-3"},"Catégories",-1)),t("div",Se,[(i(!0),l(v,null,y(o.categories,e=>(i(),l("button",{key:e.id,onClick:h=>o.filterByCategory(e.id),class:R(["px-4 py-2 rounded-primea text-sm font-bold transition-all duration-200",o.selectedCategory===e.id?"bg-primea-yellow text-primea-blue":"bg-white text-primea-blue border-2 border-primea-blue hover:bg-primea-yellow hover:text-primea-blue"])},c(e.name),11,Te))),128))])]),t("div",Me,[(i(!0),l(v,null,y(o.filteredEvents,e=>(i(),l("div",{key:e.id,onClick:h=>o.goToEvent(e),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105"},[t("div",Be,[e.image||e.image_url||e.image_file?(i(),l("img",{key:0,src:e.image_url||e.image||e.image_file,alt:e.title,class:"w-full h-full object-cover"},null,8,qe)):u("",!0),r[17]||(r[17]=t("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),t("div",Re,[t("div",je,[t("div",Ne,[t("div",De,c(e.category?.name||e.category_name||"ÉVÉNEMENT"),1),t("div",ze,c(e.title),1)]),t("div",Fe,[t("div",Ie,c(o.formatEventDate(e.event_date||e.date)),1),e.min_age?(i(),l("div",Ve,c(e.min_age)+"+",1)):u("",!0)])]),t("div",Qe,[t("div",Ae,[t("div",Pe,[t("div",Xe,[e.min_price&&e.min_price>0?(i(),l("div",He,c(o.formatPrice(e.min_price))+" XAF ",1)):u("",!0),e.max_price&&e.max_price>0&&e.max_price!==e.min_price?(i(),l("div",Oe,c(o.formatPrice(e.max_price))+" XAF ",1)):u("",!0)]),t("div",Ge,c(e.venue?.name||e.venue_name||"Lieu à confirmer"),1)]),t("div",Ue,[r[16]||(r[16]=t("div",{class:"text-xs text-gray-200"},"Organisé par",-1)),t("div",We,c(e.organizer?.name||"Organisateur"),1)])])])])])],8,Le))),128))]),o.filteredEvents.length===0&&!o.loading?(i(),l("div",Ye,[o.eventsStore.error?(i(),l("div",Ze,[r[18]||(r[18]=t("div",{class:"text-lg font-semibold mb-2"},"⚠️ Erreur de connexion",-1)),t("div",Je,c(o.eventsStore.error),1)])):(i(),l("div",Ke,"Aucun événement disponible pour le moment.")),j(w,{to:"/",class:"text-primea-yellow hover:text-white font-medium"},{default:G(()=>[...r[19]||(r[19]=[T(" ← Retourner à l'accueil ",-1)])]),_:1})])):u("",!0)])])])}const it=ee(te,[["render",$e],["__scopeId","data-v-57a1fa56"]]);export{it as default};
