import{c as x,b as f,d as m,e as t,n as r,i as C,t as c,A as g,U as y,F as z,g as E,q as S,r as w,o as P,B as q,N as A}from"./vue-vendor-DL4qlPdi.js";import{_ as R,t as L}from"./account-UXvY6J1o.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-DSZd9EMP.js";const j={name:"TicketComponent",props:{ticket:{type:Object,required:!0},size:{type:String,default:"large",validator:o=>["small","large"].includes(o)}},setup(o){const e=x(()=>o.ticket?.event?.date?new Date(o.ticket.event.date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).toUpperCase():"DIMANCHE 27 JUILLET 2025"),a=x(()=>o.ticket?.event?.date?new Date(o.ticket.event.date).getDate():"27"),s=x(()=>o.ticket?.event?.date?new Date(o.ticket.event.date).toLocaleDateString("fr-FR",{month:"long"}).toUpperCase():"JUILLET"),l=x(()=>o.ticket?.event?.time?`DÈS ${o.ticket.event.time}`:"DÈS 13H");return{formatEventDate:e,eventDay:a,eventMonth:s,eventTime:l,formatPrice:d=>d?new Intl.NumberFormat("fr-FR").format(d):"10.000",generateQRCode:()=>{if(o.ticket?.qrCode)return o.ticket.qrCode;const d=o.ticket?.reference||"PRIMEA-TICKET";return`data:image/svg+xml;base64,${btoa(`
        <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <pattern id="qr" patternUnits="userSpaceOnUse" width="10" height="10">
              <rect width="5" height="5" fill="#000"/>
              <rect x="5" y="5" width="5" height="5" fill="#000"/>
            </pattern>
          </defs>
          <rect width="100" height="100" fill="url(#qr)"/>
          <text x="50" y="50" text-anchor="middle" fill="#333" font-size="8">${d.slice(-4)}</text>
        </svg>
      `)}`}}}},B={class:"relative"},F=["src","alt"],V={class:"flex justify-between items-start"},O={class:"flex-1"},M={class:"mb-4"},H={class:"mb-4 space-y-1"},Q={class:"font-semibold text-gray-800"},K={class:"text-gray-600 text-sm"},J={class:"mb-4"},G={class:"font-semibold text-gray-800"},X={class:"mb-4"},$={class:"mb-3"},W={class:"bg-white p-2 border-2 border-gray-300 rounded-primea"},Y=["src"];function Z(o,e,a,s,l,u){return m(),f("div",{class:r(["ticket-component bg-white rounded-primea-xl overflow-hidden font-primea",a.size==="small"?"max-w-sm":"max-w-2xl","shadow-primea-lg"])},[t("div",B,[t("div",{class:r(["relative overflow-hidden bg-primea-gradient",a.size==="small"?"h-40":"h-56"])},[a.ticket?.event?.image?(m(),f("img",{key:0,src:a.ticket.event.image,alt:a.ticket.event?.title,class:"w-full h-full object-cover"},null,8,F)):C("",!0),e[0]||(e[0]=t("div",{class:"absolute inset-0 bg-black/30"},null,-1))],2)]),t("div",{class:r(["p-4 bg-gray-50 border-t-4 border-dashed border-gray-300",a.size==="small"?"text-sm":"text-base"])},[t("div",V,[t("div",O,[t("div",M,[t("h3",{class:r(["font-bold text-primea-blue mb-2",a.size==="small"?"text-lg":"text-3xl"])},c(a.ticket?.event?.title||"L'OISEAU RARE"),3)]),t("div",H,[t("div",Q,c(s.formatEventDate),1),t("div",K,"À "+c(a.ticket?.event?.venue_name?.toUpperCase()||"ENTRE NOUS BAR"),1)]),t("div",J,[e[1]||(e[1]=t("span",{class:"text-sm text-gray-600"},"Catégorie : ",-1)),t("span",G,c(a.ticket?.ticketType||"standard"),1)]),t("div",X,[t("div",{class:r(["font-bold text-primea-blue",a.size==="small"?"text-lg":"text-2xl"])},c(s.formatPrice(a.ticket?.price))+" XAF ",3)]),e[2]||(e[2]=t("div",{class:"text-xs text-red-600 leading-tight mb-4 text-justify"},[t("strong",null,"*ATTENTION:*"),g(" CE TICKET EST STRICTEMENT PERSONNEL ET À USAGE UNIQUE. IL NE PEUT ÊTRE NI VENDU NI DONNÉ À AUTRUI SOUS PEINE D'ÊTRE REFUSÉ À L'ENTRÉE. ")],-1)),e[3]||(e[3]=t("div",{class:"flex justify-start"},[t("img",{src:"/images/logo.png",alt:"Primea",class:"h-6"})],-1))]),t("div",{class:r(["ml-4 text-center",a.size==="small"?"w-20":"w-32"])},[t("div",$,[t("div",{class:r(["font-bold text-primea-blue",a.size==="small"?"text-sm":"text-lg"])},c(a.ticket?.reference||"0001"),3)]),t("div",W,[t("img",{src:a.ticket?.qrCode||s.generateQRCode(),alt:"QR Code",class:r(["object-contain mx-auto",a.size==="small"?"w-16 h-16":"w-24 h-24"])},null,10,Y)]),e[4]||(e[4]=t("p",{class:"text-xs text-gray-500 mt-2 leading-tight"},[g(" Ce QR Code est unique"),t("br"),g(" et ne peut être scanné"),t("br"),g(" qu'une seule fois ")],-1))],2)])],2)],2)}const tt=R(j,[["render",Z],["__scopeId","data-v-852b37a9"]]),et={name:"TicketDownload",components:{TicketComponent:tt},setup(){const o=q(),e=A(),a=w(null),s=w(!0),l=w(""),u=async()=>{try{s.value=!0,l.value="";const n=o.params.id,_=await L.getTicket(n);if(_.data?.ticket){const i=_.data.ticket,I=i.event.image_url||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800";let T="2025-07-27T20:00:00";if(i.schedule?.starts_at)try{const[b,h]=i.schedule.starts_at.split(" "),[k,p,U]=b.split("/");T=`${U}-${p}-${k}T${h}`}catch(b){console.error("Error parsing date:",b)}a.value={id:i.id,reference:i.code,event:{id:i.event.id,title:i.event.title,date:T,venue_name:i.event.venue_name||"Entre Nous Bar",image:I,time:i.schedule?.door_time?(()=>{try{const[b,h]=i.schedule.door_time.split(" "),[k,p]=h.split(":");return`${k}H${p}`}catch{return"13H"}})():"13H"},ticketType:i.ticket_type?.name||"Standard",price:i.ticket_type?.price||1e4,qrCode:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(i.code)}`,status:i.status,buyer_name:i.buyer?.name,buyer_email:i.buyer?.email,issued_at:i.issued_at,used_at:i.used_at}}}catch(n){console.error("Error loading ticket:",n),l.value=n.response?.data?.message||"Erreur lors du chargement du ticket",a.value={id:o.params.id,reference:"TKT-2024-ABC123",event:{title:"L'OISEAU RARE",date:"2025-07-27T20:00:00",venue_name:"Entre Nous Bar",image:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800",time:"13H"},ticketType:"Standard",price:1e4,status:"issued"}}finally{s.value=!1}},v=x(()=>a.value?.event?.date?new Date(a.value.event.date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).toUpperCase():"DIMANCHE 27 JUILLET 2025"),d=n=>n?new Intl.NumberFormat("fr-FR").format(n):"10.000",N=async()=>{try{const n=o.params.id;window.open(`/api/v1/tickets/${n}/pdf`,"_blank")}catch(n){console.error("Download error:",n),alert("Erreur lors du téléchargement du ticket")}},D=()=>{e.back()};return P(()=>{u()}),{ticket:a,loading:s,error:l,formatEventDate:v,formatPrice:d,downloadTicket:N,goBack:D,loadTicket:u}}},at={class:"ticket-download-page min-h-screen bg-gray-50"},st={class:"container mx-auto px-4 py-6 md:py-12"},ot={class:"max-w-6xl mx-auto"},it={key:0,class:"text-center py-12"},dt={key:1,class:"bg-red-50 border-2 border-red-200 rounded-2xl md:rounded-3xl p-6 text-center max-w-md mx-auto"},nt={class:"text-red-600 mb-4"},rt={class:"md:hidden max-w-md mx-auto"},lt={class:"mb-6"},ct={class:"mb-8"},ft={class:"hidden md:grid md:grid-cols-1 lg:grid-cols-3 gap-6"},mt={class:"lg:col-span-2 flex justify-center items-start"},ut={class:"lg:col-span-1 space-y-6"},vt={class:"bg-white rounded-2xl shadow-lg p-6"},xt={class:"space-y-3"};function gt(o,e,a,s,l,u){const v=S("TicketComponent");return m(),f("div",at,[e[12]||(e[12]=y('<div class="md:hidden px-4 pt-6 pb-4" data-v-fcd37ff0><h1 class="text-xl font-bold text-blue-900 text-center" data-v-fcd37ff0>Votre ticket électronique</h1></div><div class="hidden md:block bg-white shadow-sm" data-v-fcd37ff0><div class="container mx-auto px-4 py-8 md:py-12" data-v-fcd37ff0><div class="max-w-6xl mx-auto" data-v-fcd37ff0><div class="text-center" data-v-fcd37ff0><img src="/images/logo.png" alt="Logo" class="h-16 mx-auto mb-6" data-v-fcd37ff0><h1 class="text-3xl md:text-4xl font-bold text-blue-900 mb-4" data-v-fcd37ff0>Votre ticket électronique</h1><p class="text-lg text-gray-600" data-v-fcd37ff0>Téléchargez ou capturez votre ticket pour l&#39;événement</p></div></div></div></div>',2)),t("div",st,[t("div",ot,[s.loading?(m(),f("div",it,[...e[4]||(e[4]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-900"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Chargement du ticket...",-1)])])):s.error?(m(),f("div",dt,[e[5]||(e[5]=t("div",{class:"flex items-center justify-center mb-4"},[t("svg",{class:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e[6]||(e[6]=t("h3",{class:"text-lg font-semibold text-red-800 mb-2"},"Ticket introuvable",-1)),t("p",nt,c(s.error),1),t("button",{onClick:e[0]||(e[0]=(...d)=>s.loadTicket&&s.loadTicket(...d)),class:"bg-blue-900 text-white px-6 py-3 rounded-xl hover:bg-yellow-500 hover:text-blue-900 transition-colors font-semibold"}," Réessayer ")])):s.ticket?(m(),f(z,{key:2},[t("div",rt,[e[7]||(e[7]=y('<div class="text-center mb-6" data-v-fcd37ff0><h2 class="text-base font-medium text-gray-700 mb-2" data-v-fcd37ff0> Téléchargez ou capturez l&#39;écran </h2><p class="text-sm text-gray-600" data-v-fcd37ff0> pour conserver votre ticket </p></div><div class="text-center mb-6" data-v-fcd37ff0><h2 class="text-lg font-bold text-blue-900" data-v-fcd37ff0>VOTRE TICKET</h2></div>',2)),t("div",lt,[E(v,{ticket:s.ticket,size:"small"},null,8,["ticket"])]),t("div",ct,[t("button",{onClick:e[1]||(e[1]=(...d)=>s.downloadTicket&&s.downloadTicket(...d)),class:"w-full bg-yellow-500 text-blue-900 py-4 px-6 rounded-xl font-bold transition-all duration-200 shadow-lg hover:bg-yellow-600 transform hover:scale-105"}," Télécharger ")]),e[8]||(e[8]=t("div",{class:"bg-gray-200 rounded-2xl p-8 text-center mb-6"},[t("div",{class:"text-xl text-gray-400 font-light mb-4"},"ESPACE PUB"),t("a",{href:"#",class:"text-blue-900 text-sm hover:text-yellow-500 font-semibold"},"En savoir plus...")],-1))]),t("div",ft,[t("div",mt,[E(v,{ticket:s.ticket,size:"large"},null,8,["ticket"])]),t("div",ut,[e[11]||(e[11]=y('<div class="bg-white rounded-2xl shadow-lg p-6" data-v-fcd37ff0><h3 class="text-xl font-bold text-blue-900 mb-4" data-v-fcd37ff0>Comment utiliser votre ticket</h3><div class="space-y-4 text-gray-600" data-v-fcd37ff0><div class="flex items-start gap-3" data-v-fcd37ff0><div class="rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold bg-blue-900 text-white flex-shrink-0" data-v-fcd37ff0>1</div><div data-v-fcd37ff0><p class="font-semibold text-gray-800" data-v-fcd37ff0>Téléchargez votre ticket</p><p class="text-sm" data-v-fcd37ff0>Cliquez sur le bouton de téléchargement pour sauvegarder votre ticket en PDF</p></div></div><div class="flex items-start gap-3" data-v-fcd37ff0><div class="rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold bg-blue-900 text-white flex-shrink-0" data-v-fcd37ff0>2</div><div data-v-fcd37ff0><p class="font-semibold text-gray-800" data-v-fcd37ff0>Présentez le QR code</p><p class="text-sm" data-v-fcd37ff0>À l&#39;entrée, montrez le QR code pour validation</p></div></div><div class="flex items-start gap-3" data-v-fcd37ff0><div class="rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold bg-yellow-500 text-blue-900 flex-shrink-0" data-v-fcd37ff0>!</div><div data-v-fcd37ff0><p class="font-semibold text-red-600" data-v-fcd37ff0>Important</p><p class="text-sm" data-v-fcd37ff0>Ce ticket est personnel et à usage unique. Il ne peut être ni vendu ni donné</p></div></div></div></div>',1)),t("div",vt,[e[10]||(e[10]=t("h3",{class:"text-xl font-bold text-blue-900 mb-4"},"Actions",-1)),t("div",xt,[t("button",{onClick:e[2]||(e[2]=(...d)=>s.downloadTicket&&s.downloadTicket(...d)),class:"w-full bg-yellow-500 text-blue-900 py-3 px-6 rounded-xl font-bold transition-all duration-200 shadow-lg hover:bg-yellow-600 transform hover:scale-105 flex items-center justify-center gap-2"},[...e[9]||(e[9]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),g(" Télécharger le ticket PDF ",-1)])]),t("button",{onClick:e[3]||(e[3]=(...d)=>s.goBack&&s.goBack(...d)),class:"w-full border-2 border-blue-900 text-blue-900 py-3 px-6 rounded-xl font-semibold hover:bg-blue-900 hover:text-white transition-all duration-200"}," Retour aux événements ")])])])])],64)):C("",!0)])])])}const yt=R(et,[["render",gt],["__scopeId","data-v-fcd37ff0"]]);export{yt as default};
