import{O as P,b as n,d as i,e,i as h,j as k,f as E,v as S,A as _,t as d,F as g,k as f,n as L,m as A,q as C,g as M,h as F,r as b,c as G,o as H,B as O,N as U}from"./vue-vendor-qHZ1u5cj.js";import{u as X}from"./events-Nb93pzbe.js";import{E as W}from"./EventCard-NH78Q288.js";import{_ as J}from"./account-BAoaSZQx.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-CdH4T1Hh.js";const K={name:"Events",components:{EventCard:W,ExclamationTriangleIcon:P},setup(){const v=U(),t=O(),y=X(),o=b([]),x=b(!0),m=b("all"),u=b([]),c=b(""),w=G(()=>{let s=o.value;if(m.value!=="all"&&(s=s.filter(a=>(a.category?.id||a.category_id)===parseInt(m.value))),c.value&&c.value.trim()){const a=c.value.toLowerCase().trim();s=s.filter(l=>{const q=l.title?.toLowerCase().includes(a),z=l.description?.toLowerCase().includes(a),N=l.venue_name?.toLowerCase().includes(a)||l.venue?.name?.toLowerCase().includes(a)||typeof l.venue=="string"&&l.venue?.toLowerCase().includes(a),V=l.organizer?.name?.toLowerCase().includes(a)||typeof l.organizer=="string"&&l.organizer?.toLowerCase().includes(a),D=l.category?.name?.toLowerCase().includes(a)||l.category_name?.toLowerCase().includes(a);return q||z||N||V||D})}return s}),r=async()=>{try{x.value=!0;const s=await y.fetchEvents();o.value=s.events||[]}catch(s){console.error("Erreur lors du chargement des événements:",s),o.value=[]}finally{x.value=!1}},p=async()=>{try{const s=await fetch("/api/client/categories",{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();a.success&&a.categories&&(u.value=[{id:"all",name:"Tous"},...a.categories.map(l=>({id:l.id,name:l.name,slug:l.slug}))])}catch(s){console.error("Erreur lors du chargement des catégories:",s),u.value=[{id:"all",name:"Tous"},{id:1,name:"Musique"},{id:2,name:"Culture"},{id:3,name:"Gastronomie"},{id:4,name:"Sport"},{id:5,name:"Business"}]}},R=s=>s?new Date(s).getDate().toString():"27",T=s=>s?new Intl.NumberFormat("fr-FR").format(s):"5.000",B=s=>{v.push(`/events/${s.slug}`)},Q=s=>{m.value=s.toString()},j=()=>{c.value&&c.value.trim()&&v.push({path:"/events",query:{search:c.value.trim()}})},I=()=>{c.value="",v.push({path:"/events"})};return H(()=>{t.query.search&&(c.value=t.query.search),r(),p()}),{events:o,loading:x,selectedCategory:m,categories:u,searchQuery:c,filteredEvents:w,formatEventDate:R,formatPrice:T,goToEvent:B,filterByCategory:Q,performSearch:j,clearSearch:I,loadEvents:r,loadCategories:p,eventsStore:y}}},Y={class:"events-page min-h-screen bg-gray-50 font-primea"},Z={class:"hidden md:block"},$={class:"container mx-auto px-4 py-12"},ee={class:"max-w-2xl mx-auto mb-12"},te={key:0,class:"mt-4 text-center"},oe={class:"text-gray-600"},re={class:"font-bold text-primea-blue"},se={class:"mb-12"},ie={class:"flex flex-wrap justify-center gap-4"},ae=["onClick"],ne={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 mb-16"},le={key:0,class:"text-center py-20"},de={class:"bg-white rounded-primea-xl shadow-primea-lg p-12"},ce={class:"mb-6"},me={key:0},ue={class:"text-gray-600 mb-6"},pe={key:1},he={class:"md:hidden"},be={class:"max-w-md mx-auto px-4 py-8"},ve={class:"mb-6"},xe={key:0,class:"mt-3 text-center"},ge={class:"text-white text-sm"},fe={class:"font-bold text-primea-yellow"},ye={class:"mb-6"},we={class:"flex flex-wrap gap-2"},_e=["onClick"],Ce={class:"space-y-4 mb-8"},ke=["onClick"],Ee={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},Se=["src","alt"],Le={class:"absolute inset-0 p-4 text-white"},Me={class:"flex justify-between items-start mb-4"},Re={class:"text-xs"},Te={class:"font-bold"},Be={class:"text-right text-xs"},Qe={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},je={class:"absolute bottom-4 left-4 right-4"},Ie={class:"flex justify-between items-end"},qe={class:"text-xs"},ze={class:"flex space-x-2 mb-2"},Ne={class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},Ve={class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},De={class:"text-xs text-gray-200"},Pe={class:"text-right"},Ae={class:"text-xs font-bold text-primea-yellow"},Fe={key:0,class:"text-center py-12"},Ge={key:0,class:"text-red-400 mb-4"},He={class:"text-sm"},Oe={key:1,class:"text-white/80 mb-4"};function Ue(v,t,y,o,x,m){const u=C("EventCard"),c=C("ExclamationTriangleIcon"),w=C("router-link");return i(),n("div",Y,[e("div",Z,[e("div",$,[e("div",ee,[e("form",{onSubmit:t[1]||(t[1]=k((...r)=>o.performSearch&&o.performSearch(...r),["prevent"])),class:"relative"},[E(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>o.searchQuery=r),placeholder:"Rechercher un événement par titre, lieu, organisateur...",class:"w-full px-6 py-4 rounded-primea-lg text-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow shadow-primea border-2 border-transparent focus:border-primea-yellow transition-all"},null,512),[[S,o.searchQuery]]),t[8]||(t[8]=e("button",{type:"submit",class:"absolute right-3 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-3 rounded-primea hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),o.searchQuery&&o.searchQuery.trim()?(i(),n("div",te,[e("p",oe,[t[9]||(t[9]=_(" Résultats pour: ",-1)),e("span",re,'"'+d(o.searchQuery)+'"',1),e("button",{onClick:t[2]||(t[2]=(...r)=>o.clearSearch&&o.clearSearch(...r)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ Effacer ")])])):h("",!0)]),e("div",se,[t[10]||(t[10]=e("h2",{class:"text-2xl font-bold text-primea-blue text-center mb-8"}," Filtrer par catégorie ",-1)),e("div",ie,[(i(!0),n(g,null,f(o.categories,r=>(i(),n("button",{key:r.id,onClick:p=>o.filterByCategory(r.id),class:L(["px-10 py-4 rounded-primea-lg text-lg font-bold transition-all duration-200 transform hover:scale-105 shadow-primea border-2",o.selectedCategory===r.id?"bg-primea-blue text-white border-primea-blue shadow-primea-lg scale-105":"bg-white text-primea-blue border-primea-blue hover:bg-primea-blue hover:text-white"])},d(r.name),11,ae))),128))])]),e("div",ne,[(i(!0),n(g,null,f(o.filteredEvents,r=>(i(),A(u,{key:r.id,event:r,class:"transform hover:scale-105 transition-all duration-300"},null,8,["event"]))),128))]),o.filteredEvents.length===0&&!o.loading?(i(),n("div",le,[e("div",de,[e("div",ce,[M(c,{class:"w-16 h-16 text-primea-blue/40 mx-auto"})]),o.eventsStore.error?(i(),n("div",me,[t[11]||(t[11]=e("p",{class:"text-red-600 mb-4 text-xl font-semibold"},"⚠️ Erreur de connexion",-1)),e("p",ue,d(o.eventsStore.error),1),e("button",{onClick:t[3]||(t[3]=(...r)=>o.loadEvents&&o.loadEvents(...r)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea"}," Réessayer ")])):(i(),n("div",pe,[t[12]||(t[12]=e("p",{class:"text-primea-blue mb-6 text-xl font-semibold"},"Aucun événement trouvé pour cette catégorie.",-1)),e("button",{onClick:t[4]||(t[4]=r=>o.filterByCategory("all")),class:"bg-primea-yellow text-primea-blue px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"}," Voir tous les événements ")]))])])):h("",!0)])]),e("div",he,[e("div",be,[e("div",ve,[e("form",{onSubmit:t[6]||(t[6]=k((...r)=>o.performSearch&&o.performSearch(...r),["prevent"])),class:"relative"},[E(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=r=>o.searchQuery=r),placeholder:"Rechercher un événement...",class:"w-full px-4 py-3 rounded-primea-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow"},null,512),[[S,o.searchQuery]]),t[13]||(t[13]=e("button",{type:"submit",class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-2 rounded-primea"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),o.searchQuery&&o.searchQuery.trim()?(i(),n("div",xe,[e("p",ge,[t[14]||(t[14]=_(" Résultats pour: ",-1)),e("span",fe,'"'+d(o.searchQuery)+'"',1),e("button",{onClick:t[7]||(t[7]=(...r)=>o.clearSearch&&o.clearSearch(...r)),class:"ml-2 text-primea-yellow hover:text-white font-semibold"}," ✕ ")])])):h("",!0)]),e("div",ye,[t[15]||(t[15]=e("h3",{class:"text-white text-sm font-bold mb-3"},"Catégories",-1)),e("div",we,[(i(!0),n(g,null,f(o.categories,r=>(i(),n("button",{key:r.id,onClick:p=>o.filterByCategory(r.id),class:L(["px-4 py-2 rounded-primea text-sm font-bold transition-all duration-200",o.selectedCategory===r.id?"bg-primea-yellow text-primea-blue":"bg-white/10 text-white border border-white/30 hover:bg-primea-yellow hover:text-primea-blue"])},d(r.name),11,_e))),128))])]),e("div",Ce,[(i(!0),n(g,null,f(o.filteredEvents,r=>(i(),n("div",{key:r.id,onClick:p=>o.goToEvent(r),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105"},[e("div",Ee,[r.image||r.image_url||r.image_file?(i(),n("img",{key:0,src:r.image_url||r.image||r.image_file,alt:r.title,class:"w-full h-full object-cover"},null,8,Se)):h("",!0),t[19]||(t[19]=e("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),e("div",Le,[e("div",Me,[e("div",Re,[t[16]||(t[16]=e("div",{class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold"},"CONCERT",-1)),e("div",Te,d(r.title),1)]),e("div",Be,[e("div",Qe,d(o.formatEventDate(r.date)),1),t[17]||(t[17]=e("div",{class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},"18",-1))])]),e("div",je,[e("div",Ie,[e("div",qe,[e("div",ze,[e("div",Ne,d(o.formatPrice(r.minPrice)),1),e("div",Ve,d(o.formatPrice(r.maxPrice)),1)]),e("div",De,d(r.venue),1)]),e("div",Pe,[t[18]||(t[18]=e("div",{class:"text-xs text-gray-200"},"Animation by",-1)),e("div",Ae,d(r.organizer||"MR GILLES"),1)])])])])])],8,ke))),128))]),o.filteredEvents.length===0&&!o.loading?(i(),n("div",Fe,[o.eventsStore.error?(i(),n("div",Ge,[t[20]||(t[20]=e("div",{class:"text-lg font-semibold mb-2"},"⚠️ Erreur de connexion",-1)),e("div",He,d(o.eventsStore.error),1)])):(i(),n("div",Oe,"Aucun événement disponible pour le moment.")),M(w,{to:"/",class:"text-primea-yellow hover:text-white font-medium"},{default:F(()=>[...t[21]||(t[21]=[_(" ← Retourner à l'accueil ",-1)])]),_:1})])):h("",!0)])])])}const $e=J(K,[["render",Ue],["__scopeId","data-v-37cc9a89"]]);export{$e as default};
