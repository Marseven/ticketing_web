import{d as m}from"./pinia-vendor-CdH4T1Hh.js";import{r as o,c as v}from"./vue-vendor-qHZ1u5cj.js";const P=m("events",()=>{const n=o([]),u=o(null),s=o(!1),r=o(null),c=o([]),d=o(["concert","theater","sport","conference","festival"]),g=v(()=>n.value.filter(t=>t.is_featured).slice(0,6)),h=v(()=>{const t=new Date;return n.value.filter(e=>e.schedules&&e.schedules.length>0?new Date(e.schedules[0].start_date)>t:!0)}),f=v(()=>{const t={};return n.value.forEach(e=>{e.category&&(t[e.category]||(t[e.category]=[]),t[e.category].push(e))}),t}),p=async(t={})=>{s.value=!0,r.value=null;try{const e=new URLSearchParams;t.search&&e.append("search",t.search),t.category&&e.append("category",t.category),t.city&&e.append("city",t.city),t.date&&e.append("date",t.date),t.price_range&&e.append("price_range",t.price_range),t.sort&&e.append("sort",t.sort),t.page&&e.append("page",t.page);const a=`/api/client/events${e.toString()?"?"+e.toString():""}`,l=await fetch(a,{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);const i=await l.json();n.value=i.events||i.data||[];const y=[...new Set(n.value.map(_=>_.venue_city).filter(Boolean))];return c.value=y.sort(),{events:n.value,cities:c.value,total:i.total||n.value.length,currentPage:i.current_page||1,lastPage:i.last_page||1}}catch(e){console.error("Error fetching events:",e),r.value=e.message||"Erreur lors du chargement des événements";const a=[{id:1,slug:"concert-jazz-etoiles",title:"Concert Jazz sous les étoiles",description:"Une soirée musicale exceptionnelle sous un ciel étoilé avec les plus grands artistes de jazz de la région.",venue_name:"Palais de la Culture",venue_city:"Abidjan",category_name:"Musique",image_url:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400",schedules:[{starts_at:"2025-10-15T20:00:00Z"}],ticket_types:[{name:"Billet Standard",price:25e3,quantity:300,available_quantity:268},{name:"Billet VIP",price:5e4,quantity:100,available_quantity:87}],min_price:25e3,is_featured:!0},{id:2,slug:"oiseau-rare",title:"L'OISEAU RARE",description:"Concert intimiste dans un cadre exceptionnel",venue_name:"Entre Nous Bar",venue_city:"Abidjan",category_name:"Musique",image_url:"https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=400",schedules:[{starts_at:"2025-07-27T20:00:00Z"}],ticket_types:[{name:"Entrée Standard",price:1e4,quantity:150,available_quantity:65}],min_price:1e4,is_featured:!1},{id:3,slug:"festival-arts-culture",title:"Festival Arts & Culture",description:"Un festival célébrant la richesse culturelle ivoirienne",venue_name:"Amphithéâtre National",venue_city:"Abidjan",category_name:"Culture",image_url:"https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=400",schedules:[{starts_at:"2025-09-10T14:00:00Z"}],ticket_types:[{name:"Pass Journée",price:15e3,quantity:300,available_quantity:138}],min_price:15e3,is_featured:!0}];return n.value=a,c.value=["Abidjan"],{events:a,cities:["Abidjan"],total:a.length,currentPage:1,lastPage:1}}finally{s.value=!1}};return{events:n,currentEvent:u,loading:s,error:r,cities:c,categories:d,featuredEvents:g,upcomingEvents:h,eventsByCategory:f,fetchEvents:p,fetchEvent:async t=>{s.value=!0,r.value=null;try{const e=await fetch(`/api/client/events/${t}`,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const a=await e.json();return u.value=a.event,a}catch(e){throw console.error("Error fetching event:",e),r.value=e.message||"Erreur lors du chargement de l'événement",u.value=null,e}finally{s.value=!1}},searchEvents:async t=>p({search:t}),getEventsByCategory:async t=>p({category:t}),bookTickets:async(t,e)=>{s.value=!0,r.value=null;try{const a=await fetch(`/api/client/events/${t}/book`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({tickets:e})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){throw console.error("Error booking tickets:",a),r.value=a.message||"Erreur lors de la réservation",a}finally{s.value=!1}},clearError:()=>{r.value=null}}});export{P as u};
