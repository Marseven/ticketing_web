import{b as n,d as i,e as o,j as z,i as v,n as k,f as _,v as C,g as y,q as V,as as M,t as h,A as x,h as w,r as u,B as L,o as T,N as q}from"./vue-vendor-Crt3CPuW.js";import{_ as P,P as A,u as B}from"./account-k_xqo_mH.js";import"./vendor-CzIG1j6G.js";import"./pinia-vendor-DHhcPo2H.js";const E={name:"LoginOrganizer",components:{PhoneInput:A},setup(){const m=q(),e=L(),c=B(),t=u(!1),f=u(!1),l=u(""),b=u(""),d=u(""),r=u("email");e.query.message&&(d.value=e.query.message),T(()=>{if(c.isAuthenticated&&c.user){const s=c.user.access_level||"client";s==="organizer"?m.push("/organizer/dashboard"):s==="admin"&&m.push("/admin/dashboard")}});const g=u({login:"",password:""});return{showPassword:t,loading:f,error:l,info:b,success:d,loginType:r,loginForm:g,togglePasswordVisibility:()=>{t.value=!t.value},switchLoginType:s=>{r.value=s,g.value.login="",l.value="",b.value="",d.value=""},handleLogin:async()=>{try{if(f.value=!0,l.value="",b.value="",d.value="",!g.value.login||!g.value.password)throw new Error("Veuillez remplir tous les champs");try{const s=await c.login({login:g.value.login,password:g.value.password});if(s.success){const a=s.access_level||"client";if(a!=="organizer"&&a!=="admin"){l.value="Ce compte n'est pas un compte organisateur. Veuillez utiliser la connexion client.",await c.logout(),f.value=!1;return}s.email_verification_required&&(b.value=s.message||"N'oubliez pas de vérifier votre adresse email.");const p=e.query.redirect;p?m.push(p):a==="admin"?m.push("/admin/dashboard"):m.push("/organizer/dashboard")}else{l.value=s.message||"Identifiants incorrects";return}}catch(s){if(console.error("Erreur de connexion:",s),s.response){const a=s.response.status,p=s.response.data;a===401||a===422?l.value=p.message||"Email ou mot de passe incorrect":a===403?l.value=p.message||"Accès refusé. Votre compte est peut-être inactif.":a===429?l.value="Trop de tentatives de connexion. Veuillez réessayer dans quelques minutes.":a>=500?l.value="Erreur du serveur. Veuillez réessayer plus tard.":l.value=p.message||"Une erreur est survenue lors de la connexion"}else s.request?l.value="Impossible de se connecter au serveur. Vérifiez votre connexion internet.":l.value=s.message||"Une erreur est survenue";return}}catch(s){l.value=s.message||"Erreur lors de la connexion"}finally{f.value=!1}}}}},j={class:"login-page relative overflow-hidden min-h-screen bg-white md:bg-transparent"},D={class:"relative z-10 min-h-screen md:flex md:items-center md:justify-center px-4 py-8 md:py-12"},F={class:"max-w-md w-full mx-auto"},N={class:"bg-white md:bg-white/95 md:backdrop-blur-sm rounded-2xl md:rounded-3xl shadow-lg md:shadow-2xl p-6 md:p-8"},U={class:"mb-4 md:mb-6"},I={class:"flex rounded-xl bg-gray-100 p-1 border border-gray-200"},S={key:0},H={key:1},O={class:"relative"},G=["type"],R={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},W={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Y={key:2,class:"bg-red-50 border-2 border-red-200 rounded-xl p-4"},J={class:"text-red-600 text-sm font-medium"},K={key:3,class:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4"},Q={class:"text-blue-600 text-sm font-medium"},X={key:4,class:"bg-green-50 border-2 border-green-200 rounded-xl p-4"},Z={class:"text-green-600 text-sm font-medium"},$=["disabled"],ee={key:0,class:"flex items-center justify-center"},oe={key:1},te={class:"text-center"},se={class:"mt-6 md:mt-8 pt-6 border-t border-gray-200 text-center"},le={class:"text-sm text-gray-600"},re={class:"text-sm text-gray-600 mt-2"};function ne(m,e,c,t,f,l){const b=V("PhoneInput"),d=V("router-link");return i(),n("div",j,[e[20]||(e[20]=o("div",{class:"hidden md:block absolute inset-0"},[o("img",{src:"https://images.unsplash.com/photo-1540575467063-178a50c2df87?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",alt:"Événements",class:"w-full h-full object-cover opacity-40"}),o("div",{class:"absolute inset-0 bg-blue-900/60"})],-1)),o("div",D,[o("div",F,[e[19]||(e[19]=o("div",{class:"hidden md:block text-center mb-8 animate-fade-in"},[o("img",{src:"/images/logo_white.png",alt:"Logo",class:"h-16 mx-auto mb-6"})],-1)),o("div",N,[e[18]||(e[18]=o("div",{class:"text-center mb-6 md:mb-8"},[o("h1",{class:"text-2xl md:text-3xl font-bold text-blue-900 mb-2"}," Espace Organisateur "),o("p",{class:"text-gray-600 text-sm md:text-base"}," Connectez-vous à votre compte organisateur ")],-1)),o("form",{onSubmit:e[6]||(e[6]=z((...r)=>t.handleLogin&&t.handleLogin(...r),["prevent"])),class:"space-y-5 md:space-y-6"},[o("div",U,[o("div",I,[o("button",{type:"button",onClick:e[0]||(e[0]=r=>t.switchLoginType("email")),class:k(["flex-1 py-3 px-4 text-sm font-semibold rounded-lg transition-all duration-200",t.loginType==="email"?"bg-blue-900 text-white shadow-md":"bg-transparent text-gray-600 hover:bg-yellow-500 hover:text-blue-900"])}," Email ",2),o("button",{type:"button",onClick:e[1]||(e[1]=r=>t.switchLoginType("phone")),class:k(["flex-1 py-3 px-4 text-sm font-semibold rounded-lg transition-all duration-200",t.loginType==="phone"?"bg-blue-900 text-white shadow-md":"bg-transparent text-gray-600 hover:bg-yellow-500 hover:text-blue-900"])}," Téléphone ",2)])]),t.loginType==="email"?(i(),n("div",S,[e[7]||(e[7]=o("label",{for:"email",class:"block text-sm font-semibold text-blue-900 mb-2"}," Adresse email ",-1)),_(o("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=r=>t.loginForm.login=r),placeholder:"votre.email@exemple.com",class:"w-full px-4 py-3 md:py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-blue-900 transition-all duration-200 bg-white text-base",required:""},null,512),[[C,t.loginForm.login]])])):v("",!0),t.loginType==="phone"?(i(),n("div",H,[e[8]||(e[8]=o("label",{class:"block text-sm font-semibold text-blue-900 mb-2"}," Numéro de téléphone ",-1)),y(b,{modelValue:t.loginForm.login,"onUpdate:modelValue":e[3]||(e[3]=r=>t.loginForm.login=r),placeholder:"01 23 45 67",class:"w-full",required:""},null,8,["modelValue"])])):v("",!0),o("div",null,[e[11]||(e[11]=o("label",{for:"password",class:"block text-sm font-semibold text-blue-900 mb-2"}," Mot de passe ",-1)),o("div",O,[_(o("input",{type:t.showPassword?"text":"password",id:"password","onUpdate:modelValue":e[4]||(e[4]=r=>t.loginForm.password=r),placeholder:"Votre mot de passe",class:"w-full px-4 py-3 md:py-3.5 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-yellow-500 focus:border-blue-900 transition-all duration-200 pr-12 bg-white text-base",required:""},null,8,G),[[M,t.loginForm.password]]),o("button",{type:"button",onClick:e[5]||(e[5]=(...r)=>t.togglePasswordVisibility&&t.togglePasswordVisibility(...r)),class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-blue-900 transition-colors p-1"},[t.showPassword?(i(),n("svg",R,[...e[9]||(e[9]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])])):(i(),n("svg",W,[...e[10]||(e[10]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)])]))])])]),t.error?(i(),n("div",Y,[o("p",J,h(t.error),1)])):v("",!0),t.info?(i(),n("div",K,[o("p",Q,h(t.info),1)])):v("",!0),t.success?(i(),n("div",X,[o("p",Z,h(t.success),1)])):v("",!0),o("button",{type:"submit",disabled:t.loading,class:"w-full bg-blue-900 text-white py-4 px-6 rounded-xl text-base md:text-lg font-bold transition-all duration-200 shadow-lg hover:bg-yellow-500 hover:text-blue-900 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-blue-900 disabled:hover:text-white transform hover:scale-105 disabled:transform-none"},[t.loading?(i(),n("span",ee,[...e[12]||(e[12]=[o("svg",{class:"w-5 h-5 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24"},[o("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",class:"opacity-25"}),o("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",class:"opacity-75"})],-1),x(" Connexion en cours... ",-1)])])):(i(),n("span",oe,"Se connecter"))],8,$),o("div",te,[y(d,{to:"/forgot-password",class:"text-sm text-blue-900 hover:text-yellow-500 font-semibold transition-colors duration-200 inline-block"},{default:w(()=>[...e[13]||(e[13]=[x(" Mot de passe oublié ? ",-1)])]),_:1})])],32),o("div",se,[o("p",le,[e[15]||(e[15]=x(" Vous n'avez pas de compte organisateur ? ",-1)),y(d,{to:"/register-organizer",class:"text-blue-900 hover:text-yellow-500 font-bold transition-colors duration-200 ml-1"},{default:w(()=>[...e[14]||(e[14]=[x(" Créer un compte ",-1)])]),_:1})]),o("p",re,[e[17]||(e[17]=x(" Utilisateur régulier ? ",-1)),y(d,{to:"/login",class:"text-blue-900 hover:text-yellow-500 font-semibold transition-colors duration-200 ml-1"},{default:w(()=>[...e[16]||(e[16]=[x(" Connexion client ",-1)])]),_:1})])])])])])])}const ge=P(E,[["render",ne],["__scopeId","data-v-cfda2e63"]]);export{ge as default};
