import{g as l,o as c,h as t,l as h,t as y,b as f,e as x,B as b,N as g}from"./vue-vendor-DkyC1Igy.js";import{_ as v}from"./account-CJ9MLhw4.js";import"./pinia-vendor-T35r7xXn.js";import"./vendor-BvANJOFB.js";const w={name:"PaymentSuccess",setup(){const u=b(),e=g(),a=f(!0),r=f(null),i=async()=>{try{const o=u.query.reference;if(!o)throw new Error("Référence de paiement manquante");const m=await fetch(`/api/v1/payments/${o}/status`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}),s=await m.json();if(!m.ok)throw new Error(s.message||"Erreur lors de la vérification du paiement");const n=s.data?.payment?.status||s.payment?.status;if(n==="completed"||n==="success"||n==="successful"){const p=s.data?.payment?.order?.reference||s.payment?.order?.reference||s.order?.reference;if(p)e.push({name:"ticket-success",query:{reference:p}});else throw new Error("Référence de commande introuvable")}else if(n==="pending"||n==="initiated")r.value="Votre paiement est en cours de traitement. Veuillez patienter quelques instants.",setTimeout(i,3e3);else throw new Error("Le paiement a échoué ou a expiré. Veuillez réessayer.")}catch(o){console.error("Erreur vérification paiement:",o),r.value=o.message||"Une erreur est survenue lors de la vérification du paiement",a.value=!1}},d=()=>{e.push({name:"events"})};return x(()=>{i()}),{loading:a,error:r,goToCheckout:d}}},k={class:"min-h-screen bg-gray-50 flex items-center justify-center p-4"},_={class:"bg-white rounded-primea-xl shadow-primea-lg p-8 max-w-md w-full text-center"},E={key:0},C={key:1},V={class:"text-gray-600 mb-6"};function R(u,e,a,r,i,d){return c(),l("div",k,[t("div",_,[r.loading?(c(),l("div",E,[...e[1]||(e[1]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-primea-blue mx-auto mb-4"},null,-1),t("h2",{class:"text-xl font-bold text-primea-blue mb-2"},"Vérification du paiement",-1),t("p",{class:"text-gray-600"},"Veuillez patienter...",-1)])])):r.error?(c(),l("div",C,[e[2]||(e[2]=t("div",{class:"bg-red-50 rounded-full p-4 w-16 h-16 mx-auto mb-4"},[t("svg",{class:"w-8 h-8 text-red-600 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e[3]||(e[3]=t("h2",{class:"text-xl font-bold text-red-600 mb-2"},"Erreur",-1)),t("p",V,y(r.error),1),t("button",{onClick:e[0]||(e[0]=(...o)=>r.goToCheckout&&r.goToCheckout(...o)),class:"bg-primea-blue text-white px-6 py-3 rounded-primea-lg font-semibold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200"}," Réessayer ")])):h("",!0)])])}const S=v(w,[["render",R],["__scopeId","data-v-f6fe0d7f"]]);export{S as default};
