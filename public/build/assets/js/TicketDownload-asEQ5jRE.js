import{c as x,b as m,d as u,e as t,n,i as E,t as c,A as v,U as h,F as U,g as C,q as S,r as y,o as B,B as A,N as L}from"./vue-vendor-qHZ1u5cj.js";import{_ as R,t as P}from"./account-BAoaSZQx.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-CdH4T1Hh.js";const j={name:"TicketComponent",props:{ticket:{type:Object,required:!0},size:{type:String,default:"large",validator:o=>["small","large"].includes(o)}},setup(o){const e=x(()=>o.ticket?.event?.date?new Date(o.ticket.event.date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).toUpperCase():"DIMANCHE 27 JUILLET 2025"),a=x(()=>o.ticket?.event?.date?new Date(o.ticket.event.date).getDate():"27"),s=x(()=>o.ticket?.event?.date?new Date(o.ticket.event.date).toLocaleDateString("fr-FR",{month:"long"}).toUpperCase():"JUILLET"),d=x(()=>o.ticket?.event?.time?`DÈS ${o.ticket.event.time}`:"DÈS 13H");return{formatEventDate:e,eventDay:a,eventMonth:s,eventTime:d,formatPrice:i=>i?new Intl.NumberFormat("fr-FR").format(i):"10.000",generateQRCode:()=>{if(o.ticket?.qrCode)return o.ticket.qrCode;const i=o.ticket?.reference||"PRIMEA-TICKET";return`data:image/svg+xml;base64,${btoa(`
        <svg width="100" height="100" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <pattern id="qr" patternUnits="userSpaceOnUse" width="10" height="10">
              <rect width="5" height="5" fill="#000"/>
              <rect x="5" y="5" width="5" height="5" fill="#000"/>
            </pattern>
          </defs>
          <rect width="100" height="100" fill="url(#qr)"/>
          <text x="50" y="50" text-anchor="middle" fill="#333" font-size="8">${i.slice(-4)}</text>
        </svg>
      `)}`}}}},q={class:"relative"},M=["src","alt"],F={class:"flex justify-between items-start"},V={class:"flex-1"},O={class:"mb-4"},H={class:"mb-4 space-y-1"},Q={class:"font-semibold text-gray-800"},K={class:"text-gray-600 text-sm"},J={class:"mb-4"},G={class:"font-semibold text-gray-800"},X={class:"mb-4"},W={class:"mb-3"},Y={class:"bg-white p-2 border-2 border-gray-300 rounded-primea"},Z=["src"];function $(o,e,a,s,d,b){return u(),m("div",{class:n(["ticket-component bg-white rounded-primea-xl overflow-hidden font-primea",a.size==="small"?"max-w-sm":"max-w-2xl","shadow-primea-lg"])},[t("div",q,[t("div",{class:n(["relative overflow-hidden bg-primea-gradient",a.size==="small"?"h-40":"h-56"])},[a.ticket?.event?.image?(u(),m("img",{key:0,src:a.ticket.event.image,alt:a.ticket.event?.title,class:"w-full h-full object-cover"},null,8,M)):E("",!0),e[0]||(e[0]=t("div",{class:"absolute inset-0 bg-black/30"},null,-1))],2)]),t("div",{class:n(["p-4 bg-gray-50 border-t-4 border-dashed border-gray-300",a.size==="small"?"text-sm":"text-base"])},[t("div",F,[t("div",V,[t("div",O,[t("h3",{class:n(["font-bold text-primea-blue mb-2",a.size==="small"?"text-lg":"text-3xl"])},c(a.ticket?.event?.title||"L'OISEAU RARE"),3)]),t("div",H,[t("div",Q,c(s.formatEventDate),1),t("div",K,"À "+c(a.ticket?.event?.venue_name?.toUpperCase()||"ENTRE NOUS BAR"),1)]),t("div",J,[e[1]||(e[1]=t("span",{class:"text-sm text-gray-600"},"Catégorie : ",-1)),t("span",G,c(a.ticket?.ticketType||"standard"),1)]),t("div",X,[t("div",{class:n(["font-bold text-primea-blue",a.size==="small"?"text-lg":"text-2xl"])},c(s.formatPrice(a.ticket?.price))+" XAF ",3)]),e[2]||(e[2]=t("div",{class:"text-xs text-red-600 leading-tight mb-4"},[t("strong",null,"*ATTENTION:*"),t("br"),v(" CE TICKET EST STRICTEMENT PERSONNEL ET À USAGE"),t("br"),v(" UNIQUE. IL NE PEUT ÊTRE NI VENDU NI DONNÉ À AUTRUI"),t("br"),v(" SOUS PEINE D'ÊTRE REFUSÉ À L'ENTRÉE. ")],-1)),e[3]||(e[3]=t("div",{class:"flex justify-start"},[t("img",{src:"/images/logo.png",alt:"Primea",class:"h-6"})],-1))]),t("div",{class:n(["ml-4 text-center",a.size==="small"?"w-20":"w-32"])},[t("div",W,[t("div",{class:n(["font-bold text-primea-blue",a.size==="small"?"text-sm":"text-lg"])},c(a.ticket?.reference||"0001"),3)]),t("div",Y,[t("img",{src:a.ticket?.qrCode||s.generateQRCode(),alt:"QR Code",class:n(["object-contain mx-auto",a.size==="small"?"w-16 h-16":"w-24 h-24"])},null,10,Z)]),e[4]||(e[4]=t("p",{class:"text-xs text-gray-500 mt-2 leading-tight"},[v(" Ce QR Code est unique"),t("br"),v(" et ne peut être scanné"),t("br"),v(" qu'une seule fois ")],-1))],2)])],2)],2)}const tt=R(j,[["render",$],["__scopeId","data-v-90a5349e"]]),et={name:"TicketDownload",components:{TicketComponent:tt},setup(){const o=A(),e=L(),a=y(null),s=y(!0),d=y(""),b=async()=>{try{s.value=!0,d.value="";const r=o.params.id,T=await P.getTicket(r);if(T.data?.ticket){const l=T.data.ticket,D=l.event.image_url||"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800";let _="2025-07-27T20:00:00";if(l.schedule?.starts_at)try{const[g,k]=l.schedule.starts_at.split(" "),[p,w,I]=g.split("/");_=`${I}-${w}-${p}T${k}`}catch(g){console.error("Error parsing date:",g)}a.value={id:l.id,reference:l.code,event:{id:l.event.id,title:l.event.title,date:_,venue_name:l.event.venue_name||"Entre Nous Bar",image:D,time:l.schedule?.door_time?(()=>{try{const[g,k]=l.schedule.door_time.split(" "),[p,w]=k.split(":");return`${p}H${w}`}catch{return"13H"}})():"13H"},ticketType:l.ticket_type?.name||"Standard",price:l.ticket_type?.price||1e4,qrCode:`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(l.code)}`,status:l.status,buyer_name:l.buyer?.name,buyer_email:l.buyer?.email,issued_at:l.issued_at,used_at:l.used_at}}}catch(r){console.error("Error loading ticket:",r),d.value=r.response?.data?.message||"Erreur lors du chargement du ticket",a.value={id:o.params.id,reference:"TKT-2024-ABC123",event:{title:"L'OISEAU RARE",date:"2025-07-27T20:00:00",venue_name:"Entre Nous Bar",image:"https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=800",time:"13H"},ticketType:"Standard",price:1e4,status:"issued"}}finally{s.value=!1}},f=x(()=>a.value?.event?.date?new Date(a.value.event.date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).toUpperCase():"DIMANCHE 27 JUILLET 2025"),i=r=>r?new Intl.NumberFormat("fr-FR").format(r):"10.000",z=async()=>{try{const r=o.params.id;window.open(`/api/v1/tickets/${r}/pdf`,"_blank")}catch(r){console.error("Download error:",r),alert("Erreur lors du téléchargement du ticket")}},N=()=>{e.back()};return B(()=>{b()}),{ticket:a,loading:s,error:d,formatEventDate:f,formatPrice:i,downloadTicket:z,goBack:N,loadTicket:b}}},at={class:"ticket-download-page min-h-screen bg-gray-50"},st={class:"md:hidden bg-blue-900 px-4 py-6 mb-6"},ot={class:"flex items-center justify-between mb-4"},it={class:"container mx-auto px-4 py-6 md:py-12"},lt={class:"max-w-6xl mx-auto"},rt={key:0,class:"text-center py-12"},nt={key:1,class:"bg-red-50 border-2 border-red-200 rounded-2xl md:rounded-3xl p-6 text-center max-w-md mx-auto"},dt={class:"text-red-600 mb-4"},ct={class:"md:hidden max-w-md mx-auto"},vt={class:"mb-6"},mt={class:"mb-8"},ut={class:"hidden md:grid md:grid-cols-1 lg:grid-cols-3 gap-6"},bt={class:"lg:col-span-2 flex justify-center items-start"},ft={class:"lg:col-span-1 space-y-6"},xt={class:"bg-white rounded-2xl shadow-lg p-6"},gt={class:"space-y-3"};function ht(o,e,a,s,d,b){const f=S("TicketComponent");return u(),m("div",at,[t("div",st,[t("div",ot,[t("button",{onClick:e[0]||(e[0]=(...i)=>s.goBack&&s.goBack(...i)),class:"text-white hover:text-yellow-500 transition-colors"},[...e[5]||(e[5]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e[6]||(e[6]=t("img",{src:"/images/logo_white.png",alt:"Logo",class:"h-10"},null,-1)),e[7]||(e[7]=t("div",{class:"w-6"},null,-1))]),e[8]||(e[8]=t("h1",{class:"text-xl font-bold text-white text-center"},"Votre ticket électronique",-1))]),e[17]||(e[17]=h('<div class="hidden md:block bg-white shadow-sm" data-v-c39e6bfa><div class="container mx-auto px-4 py-8 md:py-12" data-v-c39e6bfa><div class="max-w-6xl mx-auto" data-v-c39e6bfa><div class="text-center" data-v-c39e6bfa><img src="/images/logo.png" alt="Logo" class="h-16 mx-auto mb-6" data-v-c39e6bfa><h1 class="text-3xl md:text-4xl font-bold text-blue-900 mb-4" data-v-c39e6bfa>Votre ticket électronique</h1><p class="text-lg text-gray-600" data-v-c39e6bfa>Téléchargez ou capturez votre ticket pour l&#39;événement</p></div></div></div></div>',1)),t("div",it,[t("div",lt,[s.loading?(u(),m("div",rt,[...e[9]||(e[9]=[t("div",{class:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-900"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Chargement du ticket...",-1)])])):s.error?(u(),m("div",nt,[e[10]||(e[10]=t("div",{class:"flex items-center justify-center mb-4"},[t("svg",{class:"w-8 h-8 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-red-800 mb-2"},"Ticket introuvable",-1)),t("p",dt,c(s.error),1),t("button",{onClick:e[1]||(e[1]=(...i)=>s.loadTicket&&s.loadTicket(...i)),class:"bg-blue-900 text-white px-6 py-3 rounded-xl hover:bg-yellow-500 hover:text-blue-900 transition-colors font-semibold"}," Réessayer ")])):s.ticket?(u(),m(U,{key:2},[t("div",ct,[e[12]||(e[12]=h('<div class="text-center mb-6" data-v-c39e6bfa><h2 class="text-base font-medium text-gray-700 mb-2" data-v-c39e6bfa> Téléchargez ou capturez l&#39;écran </h2><p class="text-sm text-gray-600" data-v-c39e6bfa> pour conserver votre ticket </p></div><div class="text-center mb-6" data-v-c39e6bfa><h2 class="text-lg font-bold text-blue-900" data-v-c39e6bfa>VOTRE TICKET</h2></div>',2)),t("div",vt,[C(f,{ticket:s.ticket,size:"small"},null,8,["ticket"])]),t("div",mt,[t("button",{onClick:e[2]||(e[2]=(...i)=>s.downloadTicket&&s.downloadTicket(...i)),class:"w-full bg-yellow-500 text-blue-900 py-4 px-6 rounded-xl font-bold transition-all duration-200 shadow-lg hover:bg-yellow-600 transform hover:scale-105"}," Télécharger ")]),e[13]||(e[13]=h('<div class="bg-gray-200 rounded-2xl p-8 text-center mb-6" data-v-c39e6bfa><div class="text-xl text-gray-400 font-light mb-4" data-v-c39e6bfa>ESPACE PUB</div><a href="#" class="text-blue-900 text-sm hover:text-yellow-500 font-semibold" data-v-c39e6bfa>En savoir plus...</a></div><div class="text-center" data-v-c39e6bfa><img src="/images/logo.png" alt="Logo" class="h-8 mx-auto mb-4" data-v-c39e6bfa><div class="flex justify-center space-x-4" data-v-c39e6bfa><a href="#" class="text-green-500 hover:text-green-600 transition-colors" data-v-c39e6bfa><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" data-v-c39e6bfa><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.890-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488" data-v-c39e6bfa></path></svg></a><a href="#" class="text-blue-600 hover:text-blue-700 transition-colors" data-v-c39e6bfa><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" data-v-c39e6bfa><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" data-v-c39e6bfa></path></svg></a><a href="#" class="text-pink-500 hover:text-pink-600 transition-colors" data-v-c39e6bfa><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" data-v-c39e6bfa><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" data-v-c39e6bfa></path></svg></a><a href="#" class="text-gray-800 hover:text-gray-900 transition-colors" data-v-c39e6bfa><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" data-v-c39e6bfa><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z" data-v-c39e6bfa></path></svg></a></div></div>',2))]),t("div",ut,[t("div",bt,[C(f,{ticket:s.ticket,size:"large"},null,8,["ticket"])]),t("div",ft,[e[16]||(e[16]=h('<div class="bg-white rounded-2xl shadow-lg p-6" data-v-c39e6bfa><h3 class="text-xl font-bold text-blue-900 mb-4" data-v-c39e6bfa>Comment utiliser votre ticket</h3><div class="space-y-4 text-gray-600" data-v-c39e6bfa><div class="flex items-start gap-3" data-v-c39e6bfa><div class="rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold bg-blue-900 text-white flex-shrink-0" data-v-c39e6bfa>1</div><div data-v-c39e6bfa><p class="font-semibold text-gray-800" data-v-c39e6bfa>Téléchargez votre ticket</p><p class="text-sm" data-v-c39e6bfa>Cliquez sur le bouton de téléchargement pour sauvegarder votre ticket en PDF</p></div></div><div class="flex items-start gap-3" data-v-c39e6bfa><div class="rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold bg-blue-900 text-white flex-shrink-0" data-v-c39e6bfa>2</div><div data-v-c39e6bfa><p class="font-semibold text-gray-800" data-v-c39e6bfa>Présentez le QR code</p><p class="text-sm" data-v-c39e6bfa>À l&#39;entrée, montrez le QR code pour validation</p></div></div><div class="flex items-start gap-3" data-v-c39e6bfa><div class="rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold bg-yellow-500 text-blue-900 flex-shrink-0" data-v-c39e6bfa>!</div><div data-v-c39e6bfa><p class="font-semibold text-red-600" data-v-c39e6bfa>Important</p><p class="text-sm" data-v-c39e6bfa>Ce ticket est personnel et à usage unique. Il ne peut être ni vendu ni donné</p></div></div></div></div>',1)),t("div",xt,[e[15]||(e[15]=t("h3",{class:"text-xl font-bold text-blue-900 mb-4"},"Actions",-1)),t("div",gt,[t("button",{onClick:e[3]||(e[3]=(...i)=>s.downloadTicket&&s.downloadTicket(...i)),class:"w-full bg-yellow-500 text-blue-900 py-3 px-6 rounded-xl font-bold transition-all duration-200 shadow-lg hover:bg-yellow-600 transform hover:scale-105 flex items-center justify-center gap-2"},[...e[14]||(e[14]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" Télécharger le ticket PDF ",-1)])]),t("button",{onClick:e[4]||(e[4]=(...i)=>s.goBack&&s.goBack(...i)),class:"w-full border-2 border-blue-900 text-blue-900 py-3 px-6 rounded-xl font-semibold hover:bg-blue-900 hover:text-white transition-all duration-200"}," Retour aux événements ")])])])])],64)):E("",!0)])])])}const Tt=R(et,[["render",ht],["__scopeId","data-v-c39e6bfa"]]);export{Tt as default};
