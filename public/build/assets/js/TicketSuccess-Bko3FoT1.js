import{D as F,K as I,g as n,o as i,h as e,l as h,j as c,k as b,a as y,t as s,A as x,F as T,q as E,b as f,e as D,B as N,N as R}from"./vue-vendor-DkyC1Igy.js";import{_ as S,u as P}from"./account-CtxZ4SX-.js";import"./pinia-vendor-T35r7xXn.js";import"./vendor-BvANJOFB.js";const V={name:"TicketSuccess",components:{CheckCircleIcon:I,ExclamationCircleIcon:F},setup(){const w=N();R();const t=P(),u=f(!0),o=f(""),g=f(null),m=f([]),l=async()=>{const r=w.query.reference;if(!r){o.value="RÃ©fÃ©rence de commande manquante",u.value=!1;return}try{u.value=!0,o.value="";const d=t.isAuthenticated,j=d?`/api/v1/orders/${r}`:`/api/v1/guest/orders/${r}`,k={Accept:"application/json"};if(d){const A=localStorage.getItem("auth_token")||localStorage.getItem("token");A&&(k.Authorization=`Bearer ${A}`)}const C=await fetch(j,{headers:k});if(!C.ok)throw new Error("Commande introuvable");const p=await C.json();if(p.success)g.value=p.data.order,m.value=p.data.order.tickets||[];else throw new Error(p.message||"Erreur lors du chargement de la commande")}catch(d){console.error("Erreur lors du chargement de la commande:",d),o.value=d.message||"Impossible de charger votre commande"}finally{u.value=!1}},v=r=>new Intl.NumberFormat("fr-FR").format(r),_=r=>r?new Date(r).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",a=()=>{!m.value||m.value.length===0||m.value.forEach((r,d)=>{setTimeout(()=>{window.open(`/ticket/${r.code}/download`,"_blank")},d*500)})};return D(()=>{l()}),{loading:u,error:o,order:g,tickets:m,formatPrice:v,formatDate:_,downloadAllTickets:a}}},B={class:"ticket-success-page min-h-screen bg-gray-50 font-primea"},q={class:"container mx-auto px-4 py-12"},L={class:"max-w-2xl mx-auto"},U={class:"text-center mb-8"},z={key:0,class:"bg-white rounded-primea-xl shadow-primea p-8 text-center"},K={key:1,class:"bg-white rounded-primea-xl shadow-primea p-8"},M={class:"text-center mb-6"},O={class:"text-red-600"},Q={class:"text-center"},G={key:2,class:"bg-white rounded-primea-xl shadow-primea p-8"},H={class:"text-center mb-8"},J={class:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},W={class:"bg-primea-blue/5 rounded-primea-lg p-6 mb-6"},X={class:"space-y-3"},Y={class:"flex justify-between"},Z={class:"font-semibold text-primea-blue"},$={class:"flex justify-between"},ee={class:"font-semibold"},te={class:"flex justify-between"},oe={class:"font-semibold"},se={class:"flex justify-between"},re={class:"font-semibold"},ae={class:"flex justify-between"},ne={class:"font-semibold text-gray-700"},ie={class:"flex justify-between pt-2 border-t border-gray-300"},le={class:"font-bold text-green-600 text-lg"},de={class:"flex justify-between mt-3"},ce={class:"font-semibold"},me={key:0,class:"mb-6"},ue={class:"space-y-3"},be={class:"flex justify-between items-center"},xe={class:"font-semibold text-primea-blue"},pe={class:"text-sm text-gray-600"},fe={class:"text-center mb-6"},ge={class:"bg-blue-50 border border-blue-200 rounded-primea-lg p-4 mb-6 text-center"},ve={class:"text-blue-800 text-sm"},_e={class:"flex flex-col sm:flex-row gap-4 justify-center"};function he(w,t,u,o,g,m){const l=y("router-link"),v=y("ExclamationCircleIcon"),_=y("CheckCircleIcon");return i(),n("div",B,[e("div",q,[e("div",L,[e("div",U,[c(l,{to:"/"},{default:b(()=>[...t[1]||(t[1]=[e("img",{src:"/images/logo.png",alt:"Primea",class:"h-16 mx-auto mb-6"},null,-1)])]),_:1})]),o.loading?(i(),n("div",z,[...t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-primea-blue mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement de votre commande...",-1)])])):o.error?(i(),n("div",K,[e("div",M,[c(v,{class:"w-16 h-16 text-red-500 mx-auto mb-4"}),t[3]||(t[3]=e("h2",{class:"text-2xl font-bold text-red-800 mb-2"},"Erreur",-1)),e("p",O,s(o.error),1)]),e("div",Q,[c(l,{to:"/events",class:"inline-block bg-primea-blue text-white px-6 py-3 rounded-primea hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200"},{default:b(()=>[...t[4]||(t[4]=[x(" Retour aux Ã©vÃ©nements ",-1)])]),_:1})])])):o.order?(i(),n("div",G,[e("div",H,[e("div",J,[c(_,{class:"w-12 h-12 text-green-600"})]),t[5]||(t[5]=e("h1",{class:"text-3xl font-bold text-primea-blue mb-2"},"Paiement rÃ©ussi !",-1)),t[6]||(t[6]=e("p",{class:"text-gray-600"},"Votre commande a Ã©tÃ© confirmÃ©e",-1))]),e("div",W,[t[14]||(t[14]=e("h3",{class:"text-lg font-bold text-primea-blue mb-4"},"DÃ©tails de votre commande",-1)),e("div",X,[e("div",Y,[t[7]||(t[7]=e("span",{class:"text-gray-600"},"RÃ©fÃ©rence :",-1)),e("span",Z,s(o.order.reference),1)]),e("div",$,[t[8]||(t[8]=e("span",{class:"text-gray-600"},"Ã‰vÃ©nement :",-1)),e("span",ee,s(o.order.event?.title||"N/A"),1)]),e("div",te,[t[9]||(t[9]=e("span",{class:"text-gray-600"},"QuantitÃ© :",-1)),e("span",oe,s(o.order.quantity)+" ticket(s)",1)]),e("div",se,[t[10]||(t[10]=e("span",{class:"text-gray-600"},"Prix des tickets :",-1)),e("span",re,s(o.formatPrice(o.order.subtotal_amount))+" FCFA",1)]),e("div",ae,[t[11]||(t[11]=e("span",{class:"text-gray-600"},"Frais et taxes :",-1)),e("span",ne,s(o.formatPrice(o.order.total_amount-o.order.subtotal_amount))+" FCFA",1)]),e("div",ie,[t[12]||(t[12]=e("span",{class:"text-gray-800 font-semibold"},"Total payÃ© :",-1)),e("span",le,s(o.formatPrice(o.order.total_amount))+" FCFA",1)]),e("div",de,[t[13]||(t[13]=e("span",{class:"text-gray-600"},"Date :",-1)),e("span",ce,s(o.formatDate(o.order.created_at)),1)])])]),o.tickets&&o.tickets.length>0?(i(),n("div",me,[t[16]||(t[16]=e("h3",{class:"text-lg font-bold text-primea-blue mb-4"},"Vos tickets",-1)),e("div",ue,[(i(!0),n(T,null,E(o.tickets,a=>(i(),n("div",{key:a.id,class:"bg-gray-50 border-2 border-primea-blue rounded-primea-lg p-4 hover:shadow-md transition-shadow"},[e("div",be,[e("div",null,[e("p",xe,s(a.ticket_type?.name||"Ticket"),1),e("p",pe,"Code: "+s(a.code),1)]),c(l,{to:`/ticket/${a.code}/download`,class:"bg-primea-blue text-white px-4 py-2 rounded-primea text-sm hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200"},{default:b(()=>[...t[15]||(t[15]=[x(" TÃ©lÃ©charger ",-1)])]),_:1},8,["to"])])]))),128))])])):h("",!0),e("div",fe,[o.tickets&&o.tickets.length>0?(i(),n("button",{key:0,onClick:t[0]||(t[0]=(...a)=>o.downloadAllTickets&&o.downloadAllTickets(...a)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea-lg transform hover:scale-105"}," TÃ©lÃ©charger tous les tickets ")):h("",!0)]),e("div",ge,[e("p",ve,[t[17]||(t[17]=x(" ðŸ“§ Un email de confirmation avec vos tickets a Ã©tÃ© envoyÃ© Ã  ",-1)),e("strong",null,s(o.order.guest_email||"votre adresse email"),1)])]),e("div",_e,[c(l,{to:"/events",class:"text-center bg-gray-100 text-primea-blue px-6 py-3 rounded-primea hover:bg-gray-200 transition-all duration-200"},{default:b(()=>[...t[18]||(t[18]=[x(" Voir d'autres Ã©vÃ©nements ",-1)])]),_:1}),c(l,{to:"/",class:"text-center bg-primea-yellow text-primea-blue px-6 py-3 rounded-primea hover:bg-yellow-500 transition-all duration-200 font-semibold"},{default:b(()=>[...t[19]||(t[19]=[x(" Retour Ã  l'accueil ",-1)])]),_:1})])])):h("",!0)])])])}const Ae=S(V,[["render",he],["__scopeId","data-v-652de399"]]);export{Ae as default};
