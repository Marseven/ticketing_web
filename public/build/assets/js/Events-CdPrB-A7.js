import{O as A,b as l,d as a,e as t,i as u,j as C,f as E,v as S,A as w,t as c,F as v,k as f,n as T,m as D,q as k,g as L,h as P,r as g,c as X,o as O,B as G,w as H,N as U}from"./vue-vendor-DL4qlPdi.js";import{u as W}from"./events-RwIa-wgR.js";import{E as J}from"./EventCard-Bao_42qa.js";import{_ as K}from"./account-CS5tkP3W.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-DSZd9EMP.js";const Y={name:"Events",components:{EventCard:J,ExclamationTriangleIcon:A},setup(){const b=U(),r=G(),y=W(),o=g([]),x=g(!0),m=g("all"),p=g([]),d=g(""),_=X(()=>{let s=o.value;if(m.value!=="all"&&(s=s.filter(i=>(i.category?.id||i.category_id)===parseInt(m.value))),d.value&&d.value.trim()){const i=d.value.toLowerCase().trim();s=s.filter(n=>{const z=n.title?.toLowerCase().includes(i),I=n.description?.toLowerCase().includes(i),V=n.venue_name?.toLowerCase().includes(i)||n.venue?.name?.toLowerCase().includes(i)||typeof n.venue=="string"&&n.venue?.toLowerCase().includes(i),F=n.organizer?.name?.toLowerCase().includes(i)||typeof n.organizer=="string"&&n.organizer?.toLowerCase().includes(i),Q=n.category?.name?.toLowerCase().includes(i)||n.category_name?.toLowerCase().includes(i);return z||I||V||F||Q})}return s}),e=async()=>{try{x.value=!0;const s=await y.fetchEvents();o.value=s.events||[]}catch(s){console.error("Erreur lors du chargement des événements:",s),o.value=[]}finally{x.value=!1}},h=async()=>{try{const s=await fetch("/api/client/categories",{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=await s.json();i.success&&i.categories&&(p.value=[{id:"all",name:"Tous"},...i.categories.map(n=>({id:n.id,name:n.name,slug:n.slug}))])}catch(s){console.error("Erreur lors du chargement des catégories:",s),p.value=[{id:"all",name:"Tous"},{id:1,name:"Musique"},{id:2,name:"Culture"},{id:3,name:"Gastronomie"},{id:4,name:"Sport"},{id:5,name:"Business"}]}},M=s=>{if(!s)return"--";try{const i=new Date(s);return isNaN(i.getTime())?"--":i.getDate().toString().padStart(2,"0")}catch{return"--"}},B=s=>!s||s===0?"Gratuit":new Intl.NumberFormat("fr-FR").format(s),q=s=>{b.push(`/events/${s.slug}`)},R=s=>{m.value=s.toString()},j=()=>{d.value&&d.value.trim()&&b.push({path:"/events",query:{search:d.value.trim()}})},N=()=>{d.value="",b.push({path:"/events"})};return O(()=>{r.query.search&&(d.value=r.query.search),r.query.category&&(m.value=r.query.category.toString()),e(),h()}),H(()=>r.query,s=>{s.category?m.value=s.category.toString():m.value="all",s.search?d.value=s.search:!s.search&&d.value&&(d.value="")}),{events:o,loading:x,selectedCategory:m,categories:p,searchQuery:d,filteredEvents:_,formatEventDate:M,formatPrice:B,goToEvent:q,filterByCategory:R,performSearch:j,clearSearch:N,loadEvents:e,loadCategories:h,eventsStore:y}}},Z={class:"events-page min-h-screen bg-gray-50 font-primea"},$={class:"hidden md:block"},ee={class:"container mx-auto px-4 py-12"},te={class:"max-w-2xl mx-auto mb-12"},re={key:0,class:"mt-4 text-center"},oe={class:"text-gray-600"},se={class:"font-bold text-primea-blue"},ae={class:"mb-12"},ie={class:"flex flex-wrap justify-center gap-4"},le=["onClick"],ne={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 mb-16"},de={key:0,class:"text-center py-20"},ce={class:"bg-white rounded-primea-xl shadow-primea-lg p-12"},me={class:"mb-6"},ue={key:0},pe={class:"text-gray-600 mb-6"},he={key:1},ge={class:"md:hidden"},be={class:"max-w-md mx-auto px-4 py-8"},xe={class:"mb-6"},ve={key:0,class:"mt-3 text-center"},fe={class:"text-gray-800 text-sm"},ye={class:"font-bold text-primea-blue"},_e={class:"mb-6"},we={class:"flex flex-wrap gap-2"},ke=["onClick"],Ce={class:"space-y-4 mb-8"},Ee=["onClick"],Se={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},Te=["src","alt"],Le={class:"absolute inset-0 p-4 text-white"},Me={class:"flex justify-between items-start mb-4"},Be={class:"text-xs"},qe={class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold uppercase"},Re={class:"font-bold"},je={class:"text-right text-xs"},Ne={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},ze={key:0,class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},Ie={class:"absolute bottom-4 left-4 right-4"},Ve={class:"flex justify-between items-end"},Fe={class:"text-xs"},Qe={class:"flex space-x-2 mb-2"},Ae={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},De={key:1,class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},Pe={class:"text-xs text-gray-200"},Xe={class:"text-right"},Oe={class:"text-xs font-bold text-primea-yellow"},Ge={key:0,class:"text-center py-12"},He={key:0,class:"text-red-400 mb-4"},Ue={class:"text-sm"},We={key:1,class:"text-white/80 mb-4"};function Je(b,r,y,o,x,m){const p=k("EventCard"),d=k("ExclamationTriangleIcon"),_=k("router-link");return a(),l("div",Z,[t("div",$,[t("div",ee,[t("div",te,[t("form",{onSubmit:r[1]||(r[1]=C((...e)=>o.performSearch&&o.performSearch(...e),["prevent"])),class:"relative"},[E(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=e=>o.searchQuery=e),placeholder:"Rechercher un événement par titre, lieu, organisateur...",class:"w-full px-6 py-4 rounded-primea-lg text-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow shadow-primea border-2 border-transparent focus:border-primea-yellow transition-all"},null,512),[[S,o.searchQuery]]),r[8]||(r[8]=t("button",{type:"submit",class:"absolute right-3 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-3 rounded-primea hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),o.searchQuery&&o.searchQuery.trim()?(a(),l("div",re,[t("p",oe,[r[9]||(r[9]=w(" Résultats pour: ",-1)),t("span",se,'"'+c(o.searchQuery)+'"',1),t("button",{onClick:r[2]||(r[2]=(...e)=>o.clearSearch&&o.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ Effacer ")])])):u("",!0)]),t("div",ae,[r[10]||(r[10]=t("h2",{class:"text-2xl font-bold text-primea-blue text-center mb-8"}," Filtrer par catégorie ",-1)),t("div",ie,[(a(!0),l(v,null,f(o.categories,e=>(a(),l("button",{key:e.id,onClick:h=>o.filterByCategory(e.id),class:T(["px-10 py-4 rounded-primea-lg text-lg font-bold transition-all duration-200 transform hover:scale-105 shadow-primea border-2",o.selectedCategory===e.id?"bg-primea-blue text-white border-primea-blue shadow-primea-lg scale-105":"bg-white text-primea-blue border-primea-blue hover:bg-primea-blue hover:text-white"])},c(e.name),11,le))),128))])]),t("div",ne,[(a(!0),l(v,null,f(o.filteredEvents,e=>(a(),D(p,{key:e.id,event:e,class:"transform hover:scale-105 transition-all duration-300"},null,8,["event"]))),128))]),o.filteredEvents.length===0&&!o.loading?(a(),l("div",de,[t("div",ce,[t("div",me,[L(d,{class:"w-16 h-16 text-primea-blue/40 mx-auto"})]),o.eventsStore.error?(a(),l("div",ue,[r[11]||(r[11]=t("p",{class:"text-red-600 mb-4 text-xl font-semibold"},"⚠️ Erreur de connexion",-1)),t("p",pe,c(o.eventsStore.error),1),t("button",{onClick:r[3]||(r[3]=(...e)=>o.loadEvents&&o.loadEvents(...e)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea"}," Réessayer ")])):(a(),l("div",he,[r[12]||(r[12]=t("p",{class:"text-primea-blue mb-6 text-xl font-semibold"},"Aucun événement trouvé pour cette catégorie.",-1)),t("button",{onClick:r[4]||(r[4]=e=>o.filterByCategory("all")),class:"bg-primea-yellow text-primea-blue px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"}," Voir tous les événements ")]))])])):u("",!0)])]),t("div",ge,[t("div",be,[t("div",xe,[t("form",{onSubmit:r[6]||(r[6]=C((...e)=>o.performSearch&&o.performSearch(...e),["prevent"])),class:"relative"},[E(t("input",{type:"text","onUpdate:modelValue":r[5]||(r[5]=e=>o.searchQuery=e),placeholder:"Rechercher un événement...",class:"w-full px-4 py-3 rounded-primea-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow"},null,512),[[S,o.searchQuery]]),r[13]||(r[13]=t("button",{type:"submit",class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-2 rounded-primea"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),o.searchQuery&&o.searchQuery.trim()?(a(),l("div",ve,[t("p",fe,[r[14]||(r[14]=w(" Résultats pour: ",-1)),t("span",ye,'"'+c(o.searchQuery)+'"',1),t("button",{onClick:r[7]||(r[7]=(...e)=>o.clearSearch&&o.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ ")])])):u("",!0)]),t("div",_e,[r[15]||(r[15]=t("h3",{class:"text-gray-800 text-sm font-bold mb-3"},"Catégories",-1)),t("div",we,[(a(!0),l(v,null,f(o.categories,e=>(a(),l("button",{key:e.id,onClick:h=>o.filterByCategory(e.id),class:T(["px-4 py-2 rounded-primea text-sm font-bold transition-all duration-200",o.selectedCategory===e.id?"bg-primea-yellow text-primea-blue":"bg-white text-primea-blue border-2 border-primea-blue hover:bg-primea-yellow hover:text-primea-blue"])},c(e.name),11,ke))),128))])]),t("div",Ce,[(a(!0),l(v,null,f(o.filteredEvents,e=>(a(),l("div",{key:e.id,onClick:h=>o.goToEvent(e),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105"},[t("div",Se,[e.image||e.image_url||e.image_file?(a(),l("img",{key:0,src:e.image_url||e.image||e.image_file,alt:e.title,class:"w-full h-full object-cover"},null,8,Te)):u("",!0),r[17]||(r[17]=t("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),t("div",Le,[t("div",Me,[t("div",Be,[t("div",qe,c(e.category?.name||e.category_name||"ÉVÉNEMENT"),1),t("div",Re,c(e.title),1)]),t("div",je,[t("div",Ne,c(o.formatEventDate(e.event_date||e.date)),1),e.min_age?(a(),l("div",ze,c(e.min_age)+"+",1)):u("",!0)])]),t("div",Ie,[t("div",Ve,[t("div",Fe,[t("div",Qe,[e.min_price&&e.min_price>0?(a(),l("div",Ae,c(o.formatPrice(e.min_price))+" XAF ",1)):u("",!0),e.max_price&&e.max_price>0&&e.max_price!==e.min_price?(a(),l("div",De,c(o.formatPrice(e.max_price))+" XAF ",1)):u("",!0)]),t("div",Pe,c(e.venue?.name||e.venue_name||"Lieu à confirmer"),1)]),t("div",Xe,[r[16]||(r[16]=t("div",{class:"text-xs text-gray-200"},"Organisé par",-1)),t("div",Oe,c(e.organizer?.name||"Organisateur"),1)])])])])])],8,Ee))),128))]),o.filteredEvents.length===0&&!o.loading?(a(),l("div",Ge,[o.eventsStore.error?(a(),l("div",He,[r[18]||(r[18]=t("div",{class:"text-lg font-semibold mb-2"},"⚠️ Erreur de connexion",-1)),t("div",Ue,c(o.eventsStore.error),1)])):(a(),l("div",We,"Aucun événement disponible pour le moment.")),L(_,{to:"/",class:"text-primea-yellow hover:text-white font-medium"},{default:P(()=>[...r[19]||(r[19]=[w(" ← Retourner à l'accueil ",-1)])]),_:1})])):u("",!0)])])])}const rt=K(Y,[["render",Je],["__scopeId","data-v-36911f2f"]]);export{rt as default};
