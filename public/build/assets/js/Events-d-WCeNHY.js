import{O as W,b as l,d as i,e as t,i as c,j as S,f as z,v as D,A as h,t as d,F as v,k as f,n as R,m as q,q as T,g as N,h as Y,r as C,c as I,o as Z,B as J,w as K,N as $}from"./vue-vendor-wiowK_YT.js";import{u as ee}from"./events-BiwlR7Rs.js";import{E as te}from"./EventCard-ufma8XCH.js";import{_ as oe}from"./account-CYVf-4X6.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-xH9DYcoO.js";const re={name:"Events",components:{EventCard:te,ExclamationTriangleIcon:W},setup(){const p=$(),o=J(),L=ee(),r=C([]),E=C(!0),m=C("all"),x=C([]),u=C(""),M=s=>{try{const a=s.event_date||s.date;return a?new Date(a)<new Date:!1}catch{return!1}},e=I(()=>{let s=r.value;if(m.value!=="all"&&(s=s.filter(a=>(a.category?.id||a.category_id)===parseInt(m.value))),u.value&&u.value.trim()){const a=u.value.toLowerCase().trim();s=s.filter(n=>{const y=n.title?.toLowerCase().includes(a),_=n.description?.toLowerCase().includes(a),w=n.venue_name?.toLowerCase().includes(a)||n.venue?.name?.toLowerCase().includes(a)||typeof n.venue=="string"&&n.venue?.toLowerCase().includes(a),k=n.organizer?.name?.toLowerCase().includes(a)||typeof n.organizer=="string"&&n.organizer?.toLowerCase().includes(a),b=n.category?.name?.toLowerCase().includes(a)||n.category_name?.toLowerCase().includes(a);return y||_||w||k||b})}return s.filter(a=>!M(a))}),g=I(()=>{let s=r.value;if(m.value!=="all"&&(s=s.filter(a=>(a.category?.id||a.category_id)===parseInt(m.value))),u.value&&u.value.trim()){const a=u.value.toLowerCase().trim();s=s.filter(n=>{const y=n.title?.toLowerCase().includes(a),_=n.description?.toLowerCase().includes(a),w=n.venue_name?.toLowerCase().includes(a)||n.venue?.name?.toLowerCase().includes(a)||typeof n.venue=="string"&&n.venue?.toLowerCase().includes(a),k=n.organizer?.name?.toLowerCase().includes(a)||typeof n.organizer=="string"&&n.organizer?.toLowerCase().includes(a),b=n.category?.name?.toLowerCase().includes(a)||n.category_name?.toLowerCase().includes(a);return y||_||w||k||b})}return s.filter(a=>M(a))}),j=async()=>{try{E.value=!0;const s=await L.fetchEvents();r.value=s.events||[]}catch(s){console.error("Erreur lors du chargement des événements:",s),r.value=[]}finally{E.value=!1}},B=async()=>{try{const s=await fetch("/api/client/categories",{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const a=await s.json();a.success&&a.categories&&(x.value=[{id:"all",name:"Tous"},...a.categories.map(n=>({id:n.id,name:n.name,slug:n.slug}))])}catch(s){console.error("Erreur lors du chargement des catégories:",s),x.value=[{id:"all",name:"Tous"},{id:1,name:"Musique"},{id:2,name:"Culture"},{id:3,name:"Gastronomie"},{id:4,name:"Sport"},{id:5,name:"Business"}]}},V=s=>{if(!s)return"--";try{let a;if(s.includes("T")||s.includes("Z"))a=new Date(s);else if(s.includes("/")){const b=s.split(" "),[H,G,U]=b[0].split("/"),O=b[1]||"00:00:00";a=new Date(`${U}-${G.padStart(2,"0")}-${H.padStart(2,"0")}T${O}`)}else s.includes("-")?a=new Date(s.replace(" ","T")):a=new Date(s);if(isNaN(a.getTime()))return"--";const n=a.getDate().toString().padStart(2,"0"),y=(a.getMonth()+1).toString().padStart(2,"0"),_=a.getFullYear(),w=a.getHours().toString().padStart(2,"0"),k=a.getMinutes().toString().padStart(2,"0");return`${n}/${y}/${_} ${w}:${k}`}catch{return"--"}},F=s=>!s||s===0?"Gratuit":new Intl.NumberFormat("fr-FR").format(s),P=s=>{p.push(`/events/${s.slug}`)},A=s=>{m.value=s.toString()},Q=()=>{u.value&&u.value.trim()&&p.push({path:"/events",query:{search:u.value.trim()}})},X=()=>{u.value="",p.push({path:"/events"})};return Z(()=>{o.query.search&&(u.value=o.query.search),o.query.category&&(m.value=o.query.category.toString()),j(),B()}),K(()=>o.query,s=>{s.category?m.value=s.category.toString():m.value="all",s.search?u.value=s.search:!s.search&&u.value&&(u.value="")}),{events:r,loading:E,selectedCategory:m,categories:x,searchQuery:u,filteredEvents:e,pastEvents:g,formatEventDate:V,formatPrice:F,goToEvent:P,filterByCategory:A,performSearch:Q,clearSearch:X,loadEvents:j,loadCategories:B,eventsStore:L}}},se={class:"events-page min-h-screen bg-gray-50 font-primea"},ae={class:"hidden md:block"},ie={class:"container mx-auto px-4 py-12"},le={class:"max-w-2xl mx-auto mb-12"},ne={key:0,class:"mt-4 text-center"},de={class:"text-gray-600"},ce={class:"font-bold text-primea-blue"},ue={class:"mb-12"},me={class:"flex flex-wrap justify-center gap-4"},pe=["onClick"],ge={key:0,class:"mb-16"},he={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8"},xe={key:1,class:"mb-16"},be={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 opacity-75"},ve={key:2,class:"text-center py-20"},fe={class:"bg-white rounded-primea-xl shadow-primea-lg p-12"},ye={class:"mb-6"},_e={key:0},we={class:"text-gray-600 mb-6"},ke={key:1},Ce={class:"md:hidden"},Ee={class:"max-w-md mx-auto px-4 py-8"},Me={class:"mb-6"},Se={key:0,class:"mt-3 text-center"},Le={class:"text-gray-800 text-sm"},Te={class:"font-bold text-primea-blue"},je={class:"mb-6"},Be={class:"flex flex-wrap gap-2"},ze=["onClick"],De={key:0,class:"mb-8"},Re={class:"space-y-4"},qe=["onClick"],Ne={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},Ie=["src","alt"],Ve={class:"absolute inset-0 p-4 text-white"},Fe={class:"flex justify-between items-start mb-4"},Pe={class:"text-xs"},Ae={class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold uppercase"},Qe={class:"font-bold"},Xe={class:"text-right text-xs"},He={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},Ge={key:0,class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},Ue={class:"absolute bottom-4 left-4 right-4"},Oe={class:"flex justify-between items-end gap-2"},We={class:"text-xs flex-1"},Ye={class:"flex space-x-2 mb-2"},Ze={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},Je={key:1,class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},Ke={class:"text-xs text-gray-200"},$e=["onClick"],et={key:1,class:"mb-8"},tt={class:"space-y-4 opacity-75"},ot=["onClick"],rt={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},st=["src","alt"],at={class:"absolute inset-0 p-4 text-white"},it={class:"flex justify-between items-start mb-4"},lt={class:"text-xs"},nt={class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold uppercase"},dt={class:"font-bold"},ct={class:"text-right text-xs"},ut={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},mt={key:0,class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},pt={class:"absolute bottom-4 left-4 right-4"},gt={class:"flex justify-between items-end gap-2"},ht={class:"text-xs flex-1"},xt={class:"flex space-x-2 mb-2"},bt={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},vt={key:1,class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},ft={class:"text-xs text-gray-200"},yt=["onClick"],_t={key:2,class:"text-center py-12"},wt={key:0,class:"text-red-400 mb-4"},kt={class:"text-sm"},Ct={key:1,class:"text-white/80 mb-4"};function Et(p,o,L,r,E,m){const x=T("EventCard"),u=T("ExclamationTriangleIcon"),M=T("router-link");return i(),l("div",se,[t("div",ae,[t("div",ie,[t("div",le,[t("form",{onSubmit:o[1]||(o[1]=S((...e)=>r.performSearch&&r.performSearch(...e),["prevent"])),class:"relative"},[z(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>r.searchQuery=e),placeholder:"Rechercher un événement par titre, lieu, organisateur...",class:"w-full px-6 py-4 rounded-primea-lg text-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow shadow-primea border-2 border-transparent focus:border-primea-yellow transition-all"},null,512),[[D,r.searchQuery]]),o[8]||(o[8]=t("button",{type:"submit",class:"absolute right-3 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-3 rounded-primea hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),r.searchQuery&&r.searchQuery.trim()?(i(),l("div",ne,[t("p",de,[o[9]||(o[9]=h(" Résultats pour: ",-1)),t("span",ce,'"'+d(r.searchQuery)+'"',1),t("button",{onClick:o[2]||(o[2]=(...e)=>r.clearSearch&&r.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ Effacer ")])])):c("",!0)]),t("div",ue,[o[10]||(o[10]=t("h2",{class:"text-2xl font-bold text-primea-blue text-center mb-8"}," Filtrer par catégorie ",-1)),t("div",me,[(i(!0),l(v,null,f(r.categories,e=>(i(),l("button",{key:e.id,onClick:g=>r.filterByCategory(e.id),class:R(["px-10 py-4 rounded-primea-lg text-lg font-bold transition-all duration-200 transform hover:scale-105 shadow-primea border-2",r.selectedCategory===e.id?"bg-primea-blue text-white border-primea-blue shadow-primea-lg scale-105":"bg-white text-primea-blue border-primea-blue hover:bg-primea-blue hover:text-white"])},d(e.name),11,pe))),128))])]),r.filteredEvents.length>0?(i(),l("div",ge,[o[11]||(o[11]=t("h2",{class:"text-2xl font-bold text-primea-blue mb-8"},"Événements à venir",-1)),t("div",he,[(i(!0),l(v,null,f(r.filteredEvents,e=>(i(),q(x,{key:e.id,event:e,class:"transform hover:scale-105 transition-all duration-300"},null,8,["event"]))),128))])])):c("",!0),r.pastEvents.length>0?(i(),l("div",xe,[o[12]||(o[12]=t("h2",{class:"text-2xl font-bold text-gray-600 mb-8 flex items-center gap-2"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),h(" Événements passés ")],-1)),t("div",be,[(i(!0),l(v,null,f(r.pastEvents,e=>(i(),q(x,{key:e.id,event:e,class:"transform hover:scale-105 transition-all duration-300 grayscale hover:grayscale-0"},null,8,["event"]))),128))])])):c("",!0),r.filteredEvents.length===0&&!r.loading?(i(),l("div",ve,[t("div",fe,[t("div",ye,[N(u,{class:"w-16 h-16 text-primea-blue/40 mx-auto"})]),r.eventsStore.error?(i(),l("div",_e,[o[13]||(o[13]=t("p",{class:"text-red-600 mb-4 text-xl font-semibold"},"⚠️ Erreur de connexion",-1)),t("p",we,d(r.eventsStore.error),1),t("button",{onClick:o[3]||(o[3]=(...e)=>r.loadEvents&&r.loadEvents(...e)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea"}," Réessayer ")])):(i(),l("div",ke,[o[14]||(o[14]=t("p",{class:"text-primea-blue mb-6 text-xl font-semibold"},"Aucun événement trouvé pour cette catégorie.",-1)),t("button",{onClick:o[4]||(o[4]=e=>r.filterByCategory("all")),class:"bg-primea-yellow text-primea-blue px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"}," Voir tous les événements ")]))])])):c("",!0)])]),t("div",Ce,[t("div",Ee,[t("div",Me,[t("form",{onSubmit:o[6]||(o[6]=S((...e)=>r.performSearch&&r.performSearch(...e),["prevent"])),class:"relative"},[z(t("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=e=>r.searchQuery=e),placeholder:"Rechercher un événement...",class:"w-full px-4 py-3 rounded-primea-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow"},null,512),[[D,r.searchQuery]]),o[15]||(o[15]=t("button",{type:"submit",class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-2 rounded-primea"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),r.searchQuery&&r.searchQuery.trim()?(i(),l("div",Se,[t("p",Le,[o[16]||(o[16]=h(" Résultats pour: ",-1)),t("span",Te,'"'+d(r.searchQuery)+'"',1),t("button",{onClick:o[7]||(o[7]=(...e)=>r.clearSearch&&r.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ ")])])):c("",!0)]),t("div",je,[o[17]||(o[17]=t("h3",{class:"text-gray-800 text-sm font-bold mb-3"},"Catégories",-1)),t("div",Be,[(i(!0),l(v,null,f(r.categories,e=>(i(),l("button",{key:e.id,onClick:g=>r.filterByCategory(e.id),class:R(["px-4 py-2 rounded-primea text-sm font-bold transition-all duration-200",r.selectedCategory===e.id?"bg-primea-yellow text-primea-blue":"bg-white text-primea-blue border-2 border-primea-blue hover:bg-primea-yellow hover:text-primea-blue"])},d(e.name),11,ze))),128))])]),r.filteredEvents.length>0?(i(),l("div",De,[o[20]||(o[20]=t("h3",{class:"text-gray-800 text-lg font-bold mb-4"},"Événements à venir",-1)),t("div",Re,[(i(!0),l(v,null,f(r.filteredEvents,e=>(i(),l("div",{key:e.id,onClick:g=>r.goToEvent(e),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105"},[t("div",Ne,[e.image||e.image_url||e.image_file?(i(),l("img",{key:0,src:e.image_url||e.image||e.image_file,alt:e.title,class:"w-full h-full object-cover"},null,8,Ie)):c("",!0),o[19]||(o[19]=t("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),t("div",Ve,[t("div",Fe,[t("div",Pe,[t("div",Ae,d(e.category?.name||e.category_name||"ÉVÉNEMENT"),1),t("div",Qe,d(e.title),1)]),t("div",Xe,[t("div",He,d(r.formatEventDate(e.event_date||e.date)),1),e.min_age?(i(),l("div",Ge,d(e.min_age)+"+",1)):c("",!0)])]),t("div",Ue,[t("div",Oe,[t("div",We,[t("div",Ye,[e.min_price&&e.min_price>0?(i(),l("div",Ze,d(r.formatPrice(e.min_price))+" XAF ",1)):c("",!0),e.max_price&&e.max_price>0&&e.max_price!==e.min_price?(i(),l("div",Je,d(r.formatPrice(e.max_price))+" XAF ",1)):c("",!0)]),t("div",Ke,d(e.venue?.name||e.venue_name||"Lieu à confirmer"),1)]),p.isEventPast(e)?c("",!0):(i(),l("button",{key:0,onClick:S(g=>p.$router.push(`/checkout/${e.slug}`),["stop"]),class:"bg-yellow-500 text-blue-950 px-3 py-2 rounded-lg text-xs font-bold hover:bg-yellow-400 transition-colors flex items-center gap-1 shadow-lg flex-shrink-0"},[...o[18]||(o[18]=[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})],-1),h(" Réserver ",-1)])],8,$e))])])])])],8,qe))),128))])])):c("",!0),r.pastEvents.length>0?(i(),l("div",et,[o[23]||(o[23]=t("h3",{class:"text-gray-600 text-lg font-bold mb-4 flex items-center gap-2"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),h(" Événements passés ")],-1)),t("div",tt,[(i(!0),l(v,null,f(r.pastEvents,e=>(i(),l("div",{key:e.id,onClick:g=>r.goToEvent(e),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105 grayscale hover:grayscale-0"},[t("div",rt,[e.image||e.image_url||e.image_file?(i(),l("img",{key:0,src:e.image_url||e.image||e.image_file,alt:e.title,class:"w-full h-full object-cover"},null,8,st)):c("",!0),o[22]||(o[22]=t("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),t("div",at,[t("div",it,[t("div",lt,[t("div",nt,d(e.category?.name||e.category_name||"ÉVÉNEMENT"),1),t("div",dt,d(e.title),1)]),t("div",ct,[t("div",ut,d(r.formatEventDate(e.event_date||e.date)),1),e.min_age?(i(),l("div",mt,d(e.min_age)+"+",1)):c("",!0)])]),t("div",pt,[t("div",gt,[t("div",ht,[t("div",xt,[e.min_price&&e.min_price>0?(i(),l("div",bt,d(r.formatPrice(e.min_price))+" XAF ",1)):c("",!0),e.max_price&&e.max_price>0&&e.max_price!==e.min_price?(i(),l("div",vt,d(r.formatPrice(e.max_price))+" XAF ",1)):c("",!0)]),t("div",ft,d(e.venue?.name||e.venue_name||"Lieu à confirmer"),1)]),p.isEventPast(e)?c("",!0):(i(),l("button",{key:0,onClick:S(g=>p.$router.push(`/checkout/${e.slug}`),["stop"]),class:"bg-yellow-500 text-blue-950 px-3 py-2 rounded-lg text-xs font-bold hover:bg-yellow-400 transition-colors flex items-center gap-1 shadow-lg flex-shrink-0"},[...o[21]||(o[21]=[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})],-1),h(" Réserver ",-1)])],8,yt))])])])])],8,ot))),128))])])):c("",!0),r.filteredEvents.length===0&&!r.loading?(i(),l("div",_t,[r.eventsStore.error?(i(),l("div",wt,[o[24]||(o[24]=t("div",{class:"text-lg font-semibold mb-2"},"⚠️ Erreur de connexion",-1)),t("div",kt,d(r.eventsStore.error),1)])):(i(),l("div",Ct,"Aucun événement disponible pour le moment.")),N(M,{to:"/",class:"text-primea-yellow hover:text-white font-medium"},{default:Y(()=>[...o[25]||(o[25]=[h(" ← Retourner à l'accueil ",-1)])]),_:1})])):c("",!0)])])])}const zt=oe(re,[["render",Et],["__scopeId","data-v-5404db2b"]]);export{zt as default};
