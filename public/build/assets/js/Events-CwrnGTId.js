import{O as A,b as n,d as a,e as t,i as m,j as C,f as E,v as S,A as w,t as d,F as f,k as v,n as T,m as D,q as k,g as L,h as P,r as g,c as X,o as O,B as G,N as H}from"./vue-vendor-qHZ1u5cj.js";import{u as U}from"./events-Nb93pzbe.js";import{E as W}from"./EventCard-NH78Q288.js";import{_ as J}from"./account-BAoaSZQx.js";import"./vendor-14XLBY50.js";import"./pinia-vendor-CdH4T1Hh.js";const K={name:"Events",components:{EventCard:W,ExclamationTriangleIcon:A},setup(){const x=H(),o=G(),y=U(),r=g([]),b=g(!0),u=g("all"),p=g([]),c=g(""),_=X(()=>{let s=r.value;if(u.value!=="all"&&(s=s.filter(i=>(i.category?.id||i.category_id)===parseInt(u.value))),c.value&&c.value.trim()){const i=c.value.toLowerCase().trim();s=s.filter(l=>{const q=l.title?.toLowerCase().includes(i),z=l.description?.toLowerCase().includes(i),I=l.venue_name?.toLowerCase().includes(i)||l.venue?.name?.toLowerCase().includes(i)||typeof l.venue=="string"&&l.venue?.toLowerCase().includes(i),V=l.organizer?.name?.toLowerCase().includes(i)||typeof l.organizer=="string"&&l.organizer?.toLowerCase().includes(i),F=l.category?.name?.toLowerCase().includes(i)||l.category_name?.toLowerCase().includes(i);return q||z||I||V||F})}return s}),e=async()=>{try{b.value=!0;const s=await y.fetchEvents();r.value=s.events||[]}catch(s){console.error("Erreur lors du chargement des événements:",s),r.value=[]}finally{b.value=!1}},h=async()=>{try{const s=await fetch("/api/client/categories",{headers:{Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const i=await s.json();i.success&&i.categories&&(p.value=[{id:"all",name:"Tous"},...i.categories.map(l=>({id:l.id,name:l.name,slug:l.slug}))])}catch(s){console.error("Erreur lors du chargement des catégories:",s),p.value=[{id:"all",name:"Tous"},{id:1,name:"Musique"},{id:2,name:"Culture"},{id:3,name:"Gastronomie"},{id:4,name:"Sport"},{id:5,name:"Business"}]}},M=s=>{if(!s)return"--";try{const i=new Date(s);return isNaN(i.getTime())?"--":i.getDate().toString().padStart(2,"0")}catch{return"--"}},B=s=>!s||s===0?"Gratuit":new Intl.NumberFormat("fr-FR").format(s),Q=s=>{x.push(`/events/${s.slug}`)},R=s=>{u.value=s.toString()},j=()=>{c.value&&c.value.trim()&&x.push({path:"/events",query:{search:c.value.trim()}})},N=()=>{c.value="",x.push({path:"/events"})};return O(()=>{o.query.search&&(c.value=o.query.search),e(),h()}),{events:r,loading:b,selectedCategory:u,categories:p,searchQuery:c,filteredEvents:_,formatEventDate:M,formatPrice:B,goToEvent:Q,filterByCategory:R,performSearch:j,clearSearch:N,loadEvents:e,loadCategories:h,eventsStore:y}}},Y={class:"events-page min-h-screen bg-gray-50 font-primea"},Z={class:"hidden md:block"},$={class:"container mx-auto px-4 py-12"},ee={class:"max-w-2xl mx-auto mb-12"},te={key:0,class:"mt-4 text-center"},re={class:"text-gray-600"},oe={class:"font-bold text-primea-blue"},se={class:"mb-12"},ae={class:"flex flex-wrap justify-center gap-4"},ie=["onClick"],ne={class:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8 mb-16"},le={key:0,class:"text-center py-20"},de={class:"bg-white rounded-primea-xl shadow-primea-lg p-12"},ce={class:"mb-6"},me={key:0},ue={class:"text-gray-600 mb-6"},pe={key:1},he={class:"md:hidden"},ge={class:"max-w-md mx-auto px-4 py-8"},xe={class:"mb-6"},be={key:0,class:"mt-3 text-center"},fe={class:"text-white text-sm"},ve={class:"font-bold text-primea-yellow"},ye={class:"mb-6"},_e={class:"flex flex-wrap gap-2"},we=["onClick"],ke={class:"space-y-4 mb-8"},Ce=["onClick"],Ee={class:"h-48 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 relative overflow-hidden"},Se=["src","alt"],Te={class:"absolute inset-0 p-4 text-white"},Le={class:"flex justify-between items-start mb-4"},Me={class:"text-xs"},Be={class:"bg-primea-yellow/20 backdrop-blur-sm rounded-primea px-2 py-1 mb-1 text-primea-yellow font-bold uppercase"},Qe={class:"font-bold"},Re={class:"text-right text-xs"},je={class:"bg-primea-yellow text-primea-blue px-2 py-1 rounded-primea mb-1 font-bold"},Ne={key:0,class:"bg-red-600 text-white px-2 py-1 rounded-primea font-bold"},qe={class:"absolute bottom-4 left-4 right-4"},ze={class:"flex justify-between items-end"},Ie={class:"text-xs"},Ve={class:"flex space-x-2 mb-2"},Fe={key:0,class:"bg-green-500 text-white px-2 py-1 rounded-primea text-xs font-bold"},Ae={key:1,class:"bg-primea-blue text-white px-2 py-1 rounded-primea text-xs font-bold"},De={class:"text-xs text-gray-200"},Pe={class:"text-right"},Xe={class:"text-xs font-bold text-primea-yellow"},Oe={key:0,class:"text-center py-12"},Ge={key:0,class:"text-red-400 mb-4"},He={class:"text-sm"},Ue={key:1,class:"text-white/80 mb-4"};function We(x,o,y,r,b,u){const p=k("EventCard"),c=k("ExclamationTriangleIcon"),_=k("router-link");return a(),n("div",Y,[t("div",Z,[t("div",$,[t("div",ee,[t("form",{onSubmit:o[1]||(o[1]=C((...e)=>r.performSearch&&r.performSearch(...e),["prevent"])),class:"relative"},[E(t("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>r.searchQuery=e),placeholder:"Rechercher un événement par titre, lieu, organisateur...",class:"w-full px-6 py-4 rounded-primea-lg text-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow shadow-primea border-2 border-transparent focus:border-primea-yellow transition-all"},null,512),[[S,r.searchQuery]]),o[8]||(o[8]=t("button",{type:"submit",class:"absolute right-3 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-3 rounded-primea hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"},[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),r.searchQuery&&r.searchQuery.trim()?(a(),n("div",te,[t("p",re,[o[9]||(o[9]=w(" Résultats pour: ",-1)),t("span",oe,'"'+d(r.searchQuery)+'"',1),t("button",{onClick:o[2]||(o[2]=(...e)=>r.clearSearch&&r.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-primea-blue font-semibold"}," ✕ Effacer ")])])):m("",!0)]),t("div",se,[o[10]||(o[10]=t("h2",{class:"text-2xl font-bold text-primea-blue text-center mb-8"}," Filtrer par catégorie ",-1)),t("div",ae,[(a(!0),n(f,null,v(r.categories,e=>(a(),n("button",{key:e.id,onClick:h=>r.filterByCategory(e.id),class:T(["px-10 py-4 rounded-primea-lg text-lg font-bold transition-all duration-200 transform hover:scale-105 shadow-primea border-2",r.selectedCategory===e.id?"bg-primea-blue text-white border-primea-blue shadow-primea-lg scale-105":"bg-white text-primea-blue border-primea-blue hover:bg-primea-blue hover:text-white"])},d(e.name),11,ie))),128))])]),t("div",ne,[(a(!0),n(f,null,v(r.filteredEvents,e=>(a(),D(p,{key:e.id,event:e,class:"transform hover:scale-105 transition-all duration-300"},null,8,["event"]))),128))]),r.filteredEvents.length===0&&!r.loading?(a(),n("div",le,[t("div",de,[t("div",ce,[L(c,{class:"w-16 h-16 text-primea-blue/40 mx-auto"})]),r.eventsStore.error?(a(),n("div",me,[o[11]||(o[11]=t("p",{class:"text-red-600 mb-4 text-xl font-semibold"},"⚠️ Erreur de connexion",-1)),t("p",ue,d(r.eventsStore.error),1),t("button",{onClick:o[3]||(o[3]=(...e)=>r.loadEvents&&r.loadEvents(...e)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea"}," Réessayer ")])):(a(),n("div",pe,[o[12]||(o[12]=t("p",{class:"text-primea-blue mb-6 text-xl font-semibold"},"Aucun événement trouvé pour cette catégorie.",-1)),t("button",{onClick:o[4]||(o[4]=e=>r.filterByCategory("all")),class:"bg-primea-yellow text-primea-blue px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-blue hover:text-white transition-all duration-200 shadow-primea"}," Voir tous les événements ")]))])])):m("",!0)])]),t("div",he,[t("div",ge,[t("div",xe,[t("form",{onSubmit:o[6]||(o[6]=C((...e)=>r.performSearch&&r.performSearch(...e),["prevent"])),class:"relative"},[E(t("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=e=>r.searchQuery=e),placeholder:"Rechercher un événement...",class:"w-full px-4 py-3 rounded-primea-lg bg-white text-primea-blue placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primea-yellow"},null,512),[[S,r.searchQuery]]),o[13]||(o[13]=t("button",{type:"submit",class:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-primea-yellow text-primea-blue p-2 rounded-primea"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))],32),r.searchQuery&&r.searchQuery.trim()?(a(),n("div",be,[t("p",fe,[o[14]||(o[14]=w(" Résultats pour: ",-1)),t("span",ve,'"'+d(r.searchQuery)+'"',1),t("button",{onClick:o[7]||(o[7]=(...e)=>r.clearSearch&&r.clearSearch(...e)),class:"ml-2 text-primea-yellow hover:text-white font-semibold"}," ✕ ")])])):m("",!0)]),t("div",ye,[o[15]||(o[15]=t("h3",{class:"text-white text-sm font-bold mb-3"},"Catégories",-1)),t("div",_e,[(a(!0),n(f,null,v(r.categories,e=>(a(),n("button",{key:e.id,onClick:h=>r.filterByCategory(e.id),class:T(["px-4 py-2 rounded-primea text-sm font-bold transition-all duration-200",r.selectedCategory===e.id?"bg-primea-yellow text-primea-blue":"bg-white/10 text-white border border-white/30 hover:bg-primea-yellow hover:text-primea-blue"])},d(e.name),11,we))),128))])]),t("div",ke,[(a(!0),n(f,null,v(r.filteredEvents,e=>(a(),n("div",{key:e.id,onClick:h=>r.goToEvent(e),class:"bg-white rounded-primea-lg shadow-primea overflow-hidden cursor-pointer hover:shadow-primea-lg transition-all duration-300 transform hover:scale-105"},[t("div",Ee,[e.image||e.image_url||e.image_file?(a(),n("img",{key:0,src:e.image_url||e.image||e.image_file,alt:e.title,class:"w-full h-full object-cover"},null,8,Se)):m("",!0),o[17]||(o[17]=t("div",{class:"absolute inset-0 bg-primea-blue/40"},null,-1)),t("div",Te,[t("div",Le,[t("div",Me,[t("div",Be,d(e.category?.name||e.category_name||"ÉVÉNEMENT"),1),t("div",Qe,d(e.title),1)]),t("div",Re,[t("div",je,d(r.formatEventDate(e.event_date||e.date)),1),e.min_age?(a(),n("div",Ne,d(e.min_age)+"+",1)):m("",!0)])]),t("div",qe,[t("div",ze,[t("div",Ie,[t("div",Ve,[e.min_price&&e.min_price>0?(a(),n("div",Fe,d(r.formatPrice(e.min_price))+" XAF ",1)):m("",!0),e.max_price&&e.max_price>0&&e.max_price!==e.min_price?(a(),n("div",Ae,d(r.formatPrice(e.max_price))+" XAF ",1)):m("",!0)]),t("div",De,d(e.venue?.name||e.venue_name||"Lieu à confirmer"),1)]),t("div",Pe,[o[16]||(o[16]=t("div",{class:"text-xs text-gray-200"},"Organisé par",-1)),t("div",Xe,d(e.organizer?.name||"Organisateur"),1)])])])])])],8,Ce))),128))]),r.filteredEvents.length===0&&!r.loading?(a(),n("div",Oe,[r.eventsStore.error?(a(),n("div",Ge,[o[18]||(o[18]=t("div",{class:"text-lg font-semibold mb-2"},"⚠️ Erreur de connexion",-1)),t("div",He,d(r.eventsStore.error),1)])):(a(),n("div",Ue,"Aucun événement disponible pour le moment.")),L(_,{to:"/",class:"text-primea-yellow hover:text-white font-medium"},{default:P(()=>[...o[19]||(o[19]=[w(" ← Retourner à l'accueil ",-1)])]),_:1})])):m("",!0)])])])}const tt=J(K,[["render",We],["__scopeId","data-v-aa4f37f8"]]);export{tt as default};
