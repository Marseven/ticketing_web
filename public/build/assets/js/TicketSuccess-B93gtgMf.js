import{D as I,K as E,g as n,o as i,h as e,l as h,j as c,k as x,a as y,t as r,A as b,F as T,q as F,b as f,e as D,B as N,N as R}from"./vue-vendor-DkyC1Igy.js";import{_ as S,u as V}from"./account-C3HAhYAn.js";import"./pinia-vendor-T35r7xXn.js";import"./vendor-BvANJOFB.js";const B={name:"TicketSuccess",components:{CheckCircleIcon:E,ExclamationCircleIcon:I},setup(){const w=N();R();const t=V(),u=f(!0),o=f(""),g=f(null),m=f([]),l=async()=>{const s=w.query.reference;if(!s){o.value="RÃ©fÃ©rence de commande manquante",u.value=!1;return}try{u.value=!0,o.value="";const d=t.isAuthenticated,j=d?`/api/v1/orders/${s}`:`/api/v1/guest/orders/${s}`,k={Accept:"application/json"};if(d){const A=localStorage.getItem("auth_token")||localStorage.getItem("token");A&&(k.Authorization=`Bearer ${A}`)}const C=await fetch(j,{headers:k});if(!C.ok)throw new Error("Commande introuvable");const p=await C.json();if(p.success)g.value=p.data.order,m.value=p.data.order.tickets||[];else throw new Error(p.message||"Erreur lors du chargement de la commande")}catch(d){console.error("Erreur lors du chargement de la commande:",d),o.value=d.message||"Impossible de charger votre commande"}finally{u.value=!1}},v=s=>new Intl.NumberFormat("fr-FR").format(s),_=s=>s?new Date(s).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",a=()=>{!m.value||m.value.length===0||m.value.forEach((s,d)=>{setTimeout(()=>{window.open(`/ticket/${s.code}/download`,"_blank")},d*500)})};return D(()=>{l()}),{loading:u,error:o,order:g,tickets:m,formatPrice:v,formatDate:_,downloadAllTickets:a}}},P={class:"ticket-success-page min-h-screen bg-gray-50 font-primea"},q={class:"container mx-auto px-4 py-12"},L={class:"max-w-2xl mx-auto"},M={class:"text-center mb-8"},U={key:0,class:"bg-white rounded-primea-xl shadow-primea p-8 text-center"},z={key:1,class:"bg-white rounded-primea-xl shadow-primea p-8"},K={class:"text-center mb-6"},O={class:"text-red-600"},Q={class:"text-center"},G={key:2,class:"bg-white rounded-primea-xl shadow-primea p-8"},H={class:"text-center mb-8"},J={class:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},W={class:"bg-primea-blue/5 rounded-primea-lg p-6 mb-6"},X={class:"space-y-3"},Y={class:"flex justify-between"},Z={class:"font-semibold text-primea-blue"},$={class:"flex justify-between"},ee={class:"font-semibold"},te={class:"flex justify-between"},oe={class:"font-semibold"},se={class:"flex justify-between pt-2 border-t border-gray-300"},re={class:"font-bold text-green-600 text-lg"},ae={class:"flex justify-between"},ne={class:"text-xs text-gray-500"},ie={class:"flex justify-between mt-3"},le={class:"font-semibold"},de={key:0,class:"mb-6"},ce={class:"space-y-3"},me={class:"flex justify-between items-center"},ue={class:"font-semibold text-primea-blue"},xe={class:"text-sm text-gray-600"},be={class:"text-center mb-6"},pe={class:"bg-blue-50 border border-blue-200 rounded-primea-lg p-4 mb-6 text-center"},fe={class:"text-blue-800 text-sm"},ge={class:"flex flex-col sm:flex-row gap-4 justify-center"};function ve(w,t,u,o,g,m){const l=y("router-link"),v=y("ExclamationCircleIcon"),_=y("CheckCircleIcon");return i(),n("div",P,[e("div",q,[e("div",L,[e("div",M,[c(l,{to:"/"},{default:x(()=>[...t[1]||(t[1]=[e("img",{src:"/images/logo.png",alt:"Primea",class:"h-16 mx-auto mb-6"},null,-1)])]),_:1})]),o.loading?(i(),n("div",U,[...t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-primea-blue mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement de votre commande...",-1)])])):o.error?(i(),n("div",z,[e("div",K,[c(v,{class:"w-16 h-16 text-red-500 mx-auto mb-4"}),t[3]||(t[3]=e("h2",{class:"text-2xl font-bold text-red-800 mb-2"},"Erreur",-1)),e("p",O,r(o.error),1)]),e("div",Q,[c(l,{to:"/events",class:"inline-block bg-primea-blue text-white px-6 py-3 rounded-primea hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200"},{default:x(()=>[...t[4]||(t[4]=[b(" Retour aux Ã©vÃ©nements ",-1)])]),_:1})])])):o.order?(i(),n("div",G,[e("div",H,[e("div",J,[c(_,{class:"w-12 h-12 text-green-600"})]),t[5]||(t[5]=e("h1",{class:"text-3xl font-bold text-primea-blue mb-2"},"Paiement rÃ©ussi !",-1)),t[6]||(t[6]=e("p",{class:"text-gray-600"},"Votre commande a Ã©tÃ© confirmÃ©e",-1))]),e("div",W,[t[13]||(t[13]=e("h3",{class:"text-lg font-bold text-primea-blue mb-4"},"DÃ©tails de votre commande",-1)),e("div",X,[e("div",Y,[t[7]||(t[7]=e("span",{class:"text-gray-600"},"RÃ©fÃ©rence :",-1)),e("span",Z,r(o.order.reference),1)]),e("div",$,[t[8]||(t[8]=e("span",{class:"text-gray-600"},"Ã‰vÃ©nement :",-1)),e("span",ee,r(o.order.event?.title||"N/A"),1)]),e("div",te,[t[9]||(t[9]=e("span",{class:"text-gray-600"},"QuantitÃ© :",-1)),e("span",oe,r(o.order.quantity)+" ticket(s)",1)]),e("div",se,[t[10]||(t[10]=e("span",{class:"text-gray-800 font-semibold"},"Montant payÃ© :",-1)),e("span",re,r(o.formatPrice(o.order.total_amount))+" FCFA",1)]),e("div",ae,[t[11]||(t[11]=e("span",{class:"text-xs text-gray-500"},"dont frais et taxes inclus :",-1)),e("span",ne,r(o.formatPrice(o.order.fees_amount+o.order.tax_amount))+" FCFA",1)]),e("div",ie,[t[12]||(t[12]=e("span",{class:"text-gray-600"},"Date :",-1)),e("span",le,r(o.formatDate(o.order.created_at)),1)])])]),o.tickets&&o.tickets.length>0?(i(),n("div",de,[t[15]||(t[15]=e("h3",{class:"text-lg font-bold text-primea-blue mb-4"},"Vos tickets",-1)),e("div",ce,[(i(!0),n(T,null,F(o.tickets,a=>(i(),n("div",{key:a.id,class:"bg-gray-50 border-2 border-primea-blue rounded-primea-lg p-4 hover:shadow-md transition-shadow"},[e("div",me,[e("div",null,[e("p",ue,r(a.ticket_type?.name||"Ticket"),1),e("p",xe,"Code: "+r(a.code),1)]),c(l,{to:`/ticket/${a.code}/download`,class:"bg-primea-blue text-white px-4 py-2 rounded-primea text-sm hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200"},{default:x(()=>[...t[14]||(t[14]=[b(" TÃ©lÃ©charger ",-1)])]),_:1},8,["to"])])]))),128))])])):h("",!0),e("div",be,[o.tickets&&o.tickets.length>0?(i(),n("button",{key:0,onClick:t[0]||(t[0]=(...a)=>o.downloadAllTickets&&o.downloadAllTickets(...a)),class:"bg-primea-blue text-white px-8 py-3 rounded-primea-lg font-bold hover:bg-primea-yellow hover:text-primea-blue transition-all duration-200 shadow-primea-lg transform hover:scale-105"}," TÃ©lÃ©charger tous les tickets ")):h("",!0)]),e("div",pe,[e("p",fe,[t[16]||(t[16]=b(" ðŸ“§ Un email de confirmation avec vos tickets a Ã©tÃ© envoyÃ© Ã  ",-1)),e("strong",null,r(o.order.guest_email||"votre adresse email"),1)])]),e("div",ge,[c(l,{to:"/events",class:"text-center bg-gray-100 text-primea-blue px-6 py-3 rounded-primea hover:bg-gray-200 transition-all duration-200"},{default:x(()=>[...t[17]||(t[17]=[b(" Voir d'autres Ã©vÃ©nements ",-1)])]),_:1}),c(l,{to:"/",class:"text-center bg-primea-yellow text-primea-blue px-6 py-3 rounded-primea hover:bg-yellow-500 transition-all duration-200 font-semibold"},{default:x(()=>[...t[18]||(t[18]=[b(" Retour Ã  l'accueil ",-1)])]),_:1})])])):h("",!0)])])])}const ke=S(B,[["render",ve],["__scopeId","data-v-df4d7717"]]);export{ke as default};
